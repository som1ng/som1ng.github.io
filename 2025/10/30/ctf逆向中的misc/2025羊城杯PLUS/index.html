<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="VnNixUxQwNBvFc-nAdXdfYkKhdk4ncl53flMSHEm1gw">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","width":300,"display":"post","padding":18,"offset":12,"onmobile":true},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.json"};
  </script>

  <meta name="description" content="前言：通过一道例题学习一下pyd逆向，pyd就是动态链接库，和dll一样，在linux平台以.so命名 做题流程：获取方法：先用die打开pyd看py编译版本，然后在命令行对应环境运行python交互环境 12345678(py39) C:\Users\Lenovo\OneDrive\Desktop\chal&gt;pythonPython 3.9.23 | packaged by conda-f">
<meta property="og:type" content="article">
<meta property="og:title" content="2025羊城杯PLUS与pyd逆向">
<meta property="og:url" content="http://example.com/2025/10/30/ctf%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84misc/2025%E7%BE%8A%E5%9F%8E%E6%9D%AFPLUS/index.html">
<meta property="og:site_name" content="s0m1ng">
<meta property="og:description" content="前言：通过一道例题学习一下pyd逆向，pyd就是动态链接库，和dll一样，在linux平台以.so命名 做题流程：获取方法：先用die打开pyd看py编译版本，然后在命令行对应环境运行python交互环境 12345678(py39) C:\Users\Lenovo\OneDrive\Desktop\chal&gt;pythonPython 3.9.23 | packaged by conda-f">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84misc/py/pyd%E9%80%86%E5%90%91.png">
<meta property="article:published_time" content="2025-10-29T16:00:00.000Z">
<meta property="article:modified_time" content="2025-10-31T12:52:31.203Z">
<meta property="article:author" content="s0m1ng">
<meta property="article:tag" content="pyd逆向">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84misc/py/pyd%E9%80%86%E5%90%91.png">

<link rel="canonical" href="http://example.com/2025/10/30/ctf%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84misc/2025%E7%BE%8A%E5%9F%8E%E6%9D%AFPLUS/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>2025羊城杯PLUS与pyd逆向 | s0m1ng</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="s0m1ng" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">s0m1ng</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">二进制学习中</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    

  <a href="https://github.com/som1ng" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/10/30/ctf%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84misc/2025%E7%BE%8A%E5%9F%8E%E6%9D%AFPLUS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/profile_photo.jpg">
      <meta itemprop="name" content="s0m1ng">
      <meta itemprop="description" content="学习逆向贵在坚持">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="s0m1ng">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2025羊城杯PLUS与pyd逆向
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-10-30 00:00:00" itemprop="dateCreated datePublished" datetime="2025-10-30T00:00:00+08:00">2025-10-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-31 20:52:31" itemprop="dateModified" datetime="2025-10-31T20:52:31+08:00">2025-10-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ctf%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84misc/" itemprop="url" rel="index"><span itemprop="name">ctf逆向中的misc</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ctf%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84misc/py%E9%80%86%E5%90%91/" itemprop="url" rel="index"><span itemprop="name">py逆向</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
  
  <h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>通过一道例题学习一下pyd逆向，pyd就是动态链接库，和dll一样，在linux平台以.so命名</p>
<h1 id="做题流程："><a href="#做题流程：" class="headerlink" title="做题流程："></a>做题流程：</h1><h2 id="获取方法："><a href="#获取方法：" class="headerlink" title="获取方法："></a>获取方法：</h2><p>先用die打开pyd看py编译版本，然后在命令行对应环境运行python交互环境</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(py39) C:\Users\Lenovo\OneDrive\Desktop\chal&gt;python</span><br><span class="line">Python 3.9.23 | packaged by conda-forge | (main, Jun  4 2025, 17:49:16) [MSC v.1929 64 bit (AMD64)] on win32</span><br><span class="line">Type <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> or <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; import init</span><br><span class="line">&gt;&gt;&gt; x=<span class="built_in">dir</span>(init)</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span>(x)</span><br><span class="line">[<span class="string">&#x27;__builtins__&#x27;</span>, <span class="string">&#x27;__doc__&#x27;</span>, <span class="string">&#x27;__file__&#x27;</span>, <span class="string">&#x27;__loader__&#x27;</span>, <span class="string">&#x27;__name__&#x27;</span>, <span class="string">&#x27;__package__&#x27;</span>, <span class="string">&#x27;__spec__&#x27;</span>, <span class="string">&#x27;__test__&#x27;</span>, <span class="string">&#x27;a2b_hex&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;exec&#x27;</span>, <span class="string">&#x27;exit&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;int&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;p&#x27;</span>]</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>先用dir看一下导入的init.pyd都有什么方法，前面以”____”开头和结尾的是python环境内置方法，我们只需要关注a2b_hex，b，c，e，exec，exit，i，int，m，p就可以</p>
<h2 id="获取pyd方法源码"><a href="#获取pyd方法源码" class="headerlink" title="获取pyd方法源码"></a>获取pyd方法源码</h2><p>我们可以用inspect这个模块来获取方法的源码和属性，但只有def 方式声明的函数可以出现源码，如果是cpython方式编译的源码就会报错，只能另做分析</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">inspect_extract.py</span></span><br><span class="line"><span class="string">自动提取模块中可读取的源码，正常显示换行，并为每个对象生成独立源码文件。</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> inspect</span><br><span class="line"><span class="keyword">import</span> importlib</span><br><span class="line"><span class="keyword">import</span> traceback</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> textwrap <span class="keyword">import</span> indent</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">safe_get_source</span>(<span class="params">obj</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span>, inspect.getsource(obj)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span>, <span class="string">f&quot;<span class="subst">&#123;e.__class__.__name__&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">safe_getfile</span>(<span class="params">obj</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> inspect.getfile(obj)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">safe_signature</span>(<span class="params">obj</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">callable</span>(obj):</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">str</span>(inspect.signature(obj))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;&lt;签名不可用: <span class="subst">&#123;e&#125;</span>&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">summarize_doc</span>(<span class="params">doc, limit=<span class="number">200</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> doc:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    doc = doc.strip().replace(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(doc) &gt; limit:</span><br><span class="line">        <span class="keyword">return</span> doc[:limit] + <span class="string">&quot;...\n[文档省略]&quot;</span></span><br><span class="line">    <span class="keyword">return</span> doc</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sanitize_filename</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> <span class="string">&quot;\\/:*?\&quot;&lt;&gt;|&quot;</span>:</span><br><span class="line">        name = name.replace(ch, <span class="string">&quot;_&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> name</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inspect_member</span>(<span class="params">name, member, output_dir</span>):</span><br><span class="line">    info = &#123;</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: name,</span><br><span class="line">        <span class="string">&quot;type&quot;</span>: <span class="built_in">type</span>(member).__name__,</span><br><span class="line">        <span class="string">&quot;signature&quot;</span>: safe_signature(member),</span><br><span class="line">        <span class="string">&quot;file&quot;</span>: safe_getfile(member),</span><br><span class="line">        <span class="string">&quot;doc&quot;</span>: summarize_doc(inspect.getdoc(member)),</span><br><span class="line">        <span class="string">&quot;source_saved&quot;</span>: <span class="literal">False</span>,</span><br><span class="line">        <span class="string">&quot;source_file&quot;</span>: <span class="literal">None</span>,</span><br><span class="line">        <span class="string">&quot;note&quot;</span>: <span class="literal">None</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ok, src = safe_get_source(member)</span><br><span class="line">    <span class="keyword">if</span> ok:</span><br><span class="line">        filename = sanitize_filename(name) + <span class="string">&quot;.py&quot;</span></span><br><span class="line">        filepath = os.path.join(output_dir, filename)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filepath, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(<span class="string">f&quot;# Source for <span class="subst">&#123;name&#125;</span>\n\n&quot;</span>)</span><br><span class="line">            f.write(src)</span><br><span class="line">        info[<span class="string">&quot;source_saved&quot;</span>] = <span class="literal">True</span></span><br><span class="line">        info[<span class="string">&quot;source_file&quot;</span>] = filepath</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;name&#125;</span>: 源码已保存到 <span class="subst">&#123;filepath&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        info[<span class="string">&quot;note&quot;</span>] = <span class="string">f&quot;无法获取源码: <span class="subst">&#123;src&#125;</span>&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;name&#125;</span>: <span class="subst">&#123;src&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> info</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inspect_module</span>(<span class="params">mod_name</span>):</span><br><span class="line">    module = importlib.import_module(mod_name)</span><br><span class="line">    members = inspect.getmembers(module)</span><br><span class="line"></span><br><span class="line">    output_dir = <span class="string">f&quot;<span class="subst">&#123;mod_name&#125;</span>_source&quot;</span></span><br><span class="line">    os.makedirs(output_dir, exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    results = []</span><br><span class="line">    <span class="keyword">for</span> name, member <span class="keyword">in</span> members:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            info = inspect_member(name, member, output_dir)</span><br><span class="line">            results.append(info)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            results.append(&#123;</span><br><span class="line">                <span class="string">&quot;name&quot;</span>: name,</span><br><span class="line">                <span class="string">&quot;error&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;e.__class__.__name__&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span>,</span><br><span class="line">                <span class="string">&quot;traceback&quot;</span>: traceback.format_exc()</span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">    json_path = <span class="string">f&quot;<span class="subst">&#123;mod_name&#125;</span>_inspect.json&quot;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(json_path, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        json.dump(results, f, ensure_ascii=<span class="literal">False</span>, indent=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n所有源码已保存到文件夹: <span class="subst">&#123;output_dir&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;详细信息已写入: <span class="subst">&#123;json_path&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;用法: python inspect_extract.py &lt;模块名&gt;&quot;</span>) </span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line">    inspect_module(sys.argv[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<p>然后发现只有三个方法可以看源码，</p>
<p>b方法：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Source for b</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">b64encode</span>(<span class="params">s, altchars=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Encode the bytes-like object s using Base64 and return a bytes object.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Optional altchars should be a byte string of length 2 which specifies an</span></span><br><span class="line"><span class="string">    alternative alphabet for the &#x27;+&#x27; and &#x27;/&#x27; characters.  This allows an</span></span><br><span class="line"><span class="string">    application to e.g. generate url or filesystem safe Base64 strings.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    encoded = binascii.b2a_base64(s, newline=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">if</span> altchars <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(altchars) == <span class="number">2</span>, <span class="built_in">repr</span>(altchars)</span><br><span class="line">        <span class="keyword">return</span> encoded.translate(<span class="built_in">bytes</span>.maketrans(<span class="string">b&#x27;+/&#x27;</span>, altchars))</span><br><span class="line">    <span class="keyword">return</span> encoded</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>c方法：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Source for c</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Uc</span>(<span class="title class_ inherited__">RegStateManager</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Unicorn Engine class.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__is_compliant</span>() -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Checks whether Unicorn binding version complies with Unicorn library.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns: `True` if versions match, `False` otherwise</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        uc_maj, uc_min, _ = uc_version()</span><br><span class="line">        bnd_maj, bnd_min, _ = version_bind()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (uc_maj, uc_min) == (bnd_maj, bnd_min)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__new__</span>(<span class="params">cls, arch: <span class="built_in">int</span>, mode: <span class="built_in">int</span>, cpu: <span class="type">Optional</span>[<span class="built_in">int</span>] = <span class="literal">None</span></span>):</span><br><span class="line">        <span class="comment"># verify version compatibility with the core before doing anything</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> Uc.__is_compliant():</span><br><span class="line">            <span class="keyword">raise</span> UcError(uc.UC_ERR_VERSION)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">import</span> importlib</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">__uc_subclass</span>(<span class="params">pkgname: <span class="built_in">str</span>, clsname: <span class="built_in">str</span></span>):</span><br><span class="line">            <span class="string">&quot;&quot;&quot;Use a lazy subclass instantiation to avoid importing unnecessary arch</span></span><br><span class="line"><span class="string">            classes.</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">__wrapped</span>() -&gt; <span class="type">Type</span>[Uc]:</span><br><span class="line">                archmod = importlib.import_module(<span class="string">f&#x27;.arch.<span class="subst">&#123;pkgname&#125;</span>&#x27;</span>, <span class="string">&#x27;unicorn.unicorn_py3&#x27;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">getattr</span>(archmod, clsname)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> __wrapped</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">__uc_generic</span>():</span><br><span class="line">            <span class="keyword">return</span> Uc</span><br><span class="line"></span><br><span class="line">        wrapped: <span class="type">Callable</span>[[], <span class="type">Type</span>[Uc]] = &#123;</span><br><span class="line">            uc.UC_ARCH_ARM     : __uc_subclass(<span class="string">&#x27;arm&#x27;</span>, <span class="string">&#x27;UcAArch32&#x27;</span>),</span><br><span class="line">            uc.UC_ARCH_ARM64   : __uc_subclass(<span class="string">&#x27;arm64&#x27;</span>, <span class="string">&#x27;UcAArch64&#x27;</span>),</span><br><span class="line">            uc.UC_ARCH_MIPS    : __uc_generic,</span><br><span class="line">            uc.UC_ARCH_X86     : __uc_subclass(<span class="string">&#x27;intel&#x27;</span>, <span class="string">&#x27;UcIntel&#x27;</span>),</span><br><span class="line">            uc.UC_ARCH_PPC     : __uc_generic,</span><br><span class="line">            uc.UC_ARCH_SPARC   : __uc_generic,</span><br><span class="line">            uc.UC_ARCH_M68K    : __uc_generic,</span><br><span class="line">            uc.UC_ARCH_RISCV   : __uc_generic,</span><br><span class="line">            uc.UC_ARCH_S390X   : __uc_generic,</span><br><span class="line">            uc.UC_ARCH_TRICORE : __uc_generic</span><br><span class="line">        &#125;[arch]</span><br><span class="line"></span><br><span class="line">        subclass = wrapped()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># return the appropriate unicorn subclass type</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>(Uc, cls).__new__(subclass)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, arch: <span class="built_in">int</span>, mode: <span class="built_in">int</span>, cpu: <span class="type">Optional</span>[<span class="built_in">int</span>] = <span class="literal">None</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Initialize a Unicorn engine instance.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            arch: emulated architecture identifier (see UC_ARCH_* constants)</span></span><br><span class="line"><span class="string">            mode: emulated processor mode (see UC_MODE_* constants)</span></span><br><span class="line"><span class="string">            cpu: emulated cpu model (see UC_CPU_* constants) [optional]</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>._arch = arch</span><br><span class="line">        <span class="variable language_">self</span>._mode = mode</span><br><span class="line"></span><br><span class="line">        <span class="comment"># initialize the unicorn instance</span></span><br><span class="line">        <span class="variable language_">self</span>._uch = uc_engine()</span><br><span class="line">        status = uclib.uc_open(arch, mode, ctypes.byref(<span class="variable language_">self</span>._uch))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> status != uc.UC_ERR_OK:</span><br><span class="line">            <span class="variable language_">self</span>._uch = <span class="literal">None</span></span><br><span class="line">            <span class="keyword">raise</span> UcError(status)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> cpu <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="variable language_">self</span>.ctl_set_cpu_model(cpu)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># we have to keep a reference to the callbacks so they do not get gc-ed</span></span><br><span class="line">        <span class="comment"># see: https://docs.python.org/3/library/ctypes.html#callback-functions</span></span><br><span class="line">        <span class="variable language_">self</span>._callbacks: <span class="type">Dict</span>[<span class="built_in">int</span>, ctypes._FuncPointer] = &#123;&#125;</span><br><span class="line">        <span class="variable language_">self</span>._mmio_callbacks: <span class="type">Dict</span>[<span class="type">Tuple</span>[<span class="built_in">int</span>, <span class="built_in">int</span>], <span class="type">Tuple</span>[<span class="type">Optional</span>[MMIO_READ_CFUNC], <span class="type">Optional</span>[MMIO_WRITE_CFUNC]]] = &#123;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>._hook_exception: <span class="type">Optional</span>[Exception] = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># create a finalizer object that will appropriately free up resources when</span></span><br><span class="line">        <span class="comment"># this instance undergoes garbage collection.</span></span><br><span class="line">        <span class="variable language_">self</span>.__finalizer = weakref.finalize(<span class="variable language_">self</span>, Uc.release_handle, <span class="variable language_">self</span>._uch)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">release_handle</span>(<span class="params">uch: uc_engine</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="comment"># this method and its arguments must not have any reference to the Uc instance being</span></span><br><span class="line">        <span class="comment"># destroyed. namely, this method cannot be a bound method.</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> uch:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                status = uclib.uc_close(uch)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># _uc might be pulled from under our feet</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> status != uc.UC_ERR_OK:</span><br><span class="line">                    <span class="keyword">raise</span> UcError(status)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">errno</span>(<span class="params">self</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Get last error number.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns: error number (see: UC_ERR_*)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> uclib.uc_errno(<span class="variable language_">self</span>._uch)</span><br><span class="line"></span><br><span class="line">    <span class="comment">###########################</span></span><br><span class="line">    <span class="comment">#  Emulation controllers  #</span></span><br><span class="line">    <span class="comment">###########################</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">emu_start</span>(<span class="params">self, begin: <span class="built_in">int</span>, until: <span class="built_in">int</span>, timeout: <span class="built_in">int</span> = <span class="number">0</span>, count: <span class="built_in">int</span> = <span class="number">0</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Start emulation from a specified address to another.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            begin   : emulation starting address</span></span><br><span class="line"><span class="string">            until   : emulation ending address</span></span><br><span class="line"><span class="string">            timeout : limit emulation to a certain amount of time (milliseconds)</span></span><br><span class="line"><span class="string">            count   : limit emulation to a certain amount of instructions</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Raises:</span></span><br><span class="line"><span class="string">            `UcError`   : in case emulation could not be started properly</span></span><br><span class="line"><span class="string">            `Exception` : in case an error has been encountered during emulation</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>._hook_exception = <span class="literal">None</span></span><br><span class="line">        status = uclib.uc_emu_start(<span class="variable language_">self</span>._uch, begin, until, timeout, count)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> status != uc.UC_ERR_OK:</span><br><span class="line">            <span class="keyword">raise</span> UcError(status)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>._hook_exception <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">raise</span> <span class="variable language_">self</span>._hook_exception</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">emu_stop</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Stop emulation.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Raises: `UcError` in case emulation could not be stopped properly</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        status = uclib.uc_emu_stop(<span class="variable language_">self</span>._uch)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> status != uc.UC_ERR_OK:</span><br><span class="line">            <span class="keyword">raise</span> UcError(status)</span><br><span class="line"></span><br><span class="line">    <span class="comment">###########################</span></span><br><span class="line">    <span class="comment">#  CPU state accessors    #</span></span><br><span class="line">    <span class="comment">###########################</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_do_reg_read</span>(<span class="params">self, reg_id: <span class="built_in">int</span>, reg_obj</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Private register read implementation.</span></span><br><span class="line"><span class="string">        Do not call directly.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> uclib.uc_reg_read(<span class="variable language_">self</span>._uch, reg_id, reg_obj)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_do_reg_write</span>(<span class="params">self, reg_id: <span class="built_in">int</span>, reg_obj</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Private register write implementation.</span></span><br><span class="line"><span class="string">        Do not call directly.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> uclib.uc_reg_write(<span class="variable language_">self</span>._uch, reg_id, reg_obj)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_do_reg_read_batch</span>(<span class="params">self, reglist, vallist, count</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Private batch register read implementation.</span></span><br><span class="line"><span class="string">        Do not call directly.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> uclib.uc_reg_read_batch(<span class="variable language_">self</span>._uch, reglist, vallist, count)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_do_reg_write_batch</span>(<span class="params">self, reglist, vallist, count</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Private batch register write implementation.</span></span><br><span class="line"><span class="string">        Do not call directly.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> uclib.uc_reg_write_batch(<span class="variable language_">self</span>._uch, reglist, vallist, count)</span><br><span class="line"></span><br><span class="line">    <span class="comment">###########################</span></span><br><span class="line">    <span class="comment">#  Memory management      #</span></span><br><span class="line">    <span class="comment">###########################</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mem_map</span>(<span class="params">self, address: <span class="built_in">int</span>, size: <span class="built_in">int</span>, perms: <span class="built_in">int</span> = uc.UC_PROT_ALL</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Map a memory range.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            address : range base address</span></span><br><span class="line"><span class="string">            size    : range size (in bytes)</span></span><br><span class="line"><span class="string">            perms   : access protection bitmask</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Raises: `UcError` in case memory could not be mapped</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">assert</span> (perms &amp; ~uc.UC_PROT_ALL) == <span class="number">0</span>, <span class="string">&#x27;unexpected perms bitmask&#x27;</span></span><br><span class="line"></span><br><span class="line">        status = uclib.uc_mem_map(<span class="variable language_">self</span>._uch, address, size, perms)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> status != uc.UC_ERR_OK:</span><br><span class="line">            <span class="keyword">raise</span> UcError(status)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mem_map_ptr</span>(<span class="params">self, address: <span class="built_in">int</span>, size: <span class="built_in">int</span>, perms: <span class="built_in">int</span>, ptr: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Map a memory range and point to existing data on host memory.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            address : range base address</span></span><br><span class="line"><span class="string">            size    : range size (in bytes)</span></span><br><span class="line"><span class="string">            perms   : access protection bitmask</span></span><br><span class="line"><span class="string">            ptr     : address of data on host memory</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Raises: `UcError` in case memory could not be mapped</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">assert</span> (perms &amp; ~uc.UC_PROT_ALL) == <span class="number">0</span>, <span class="string">&#x27;unexpected perms bitmask&#x27;</span></span><br><span class="line"></span><br><span class="line">        status = uclib.uc_mem_map_ptr(<span class="variable language_">self</span>._uch, address, size, perms, ptr)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> status != uc.UC_ERR_OK:</span><br><span class="line">            <span class="keyword">raise</span> UcError(status)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mem_unmap</span>(<span class="params">self, address: <span class="built_in">int</span>, size: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Reclaim a mapped memory range.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            address : range base address</span></span><br><span class="line"><span class="string">            size    : range size (in bytes)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Raises: `UcError` in case memory could not be unmapped</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        status = uclib.uc_mem_unmap(<span class="variable language_">self</span>._uch, address, size)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> status != uc.UC_ERR_OK:</span><br><span class="line">            <span class="keyword">raise</span> UcError(status)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># <span class="doctag">TODO:</span> this is where mmio callbacks need to be released from cache,</span></span><br><span class="line">        <span class="comment"># but we cannot tell whether this is an mmio range. also, memory ranges</span></span><br><span class="line">        <span class="comment"># might be split by &#x27;map_protect&#x27; after they were mapped, so the</span></span><br><span class="line">        <span class="comment"># (start, end) tuple may not be suitable for retrieving the callbacks.</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># here we try to do that on a best-effort basis:</span></span><br><span class="line"></span><br><span class="line">        rng = (address, address + size)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> rng <span class="keyword">in</span> <span class="variable language_">self</span>._mmio_callbacks:</span><br><span class="line">            <span class="keyword">del</span> <span class="variable language_">self</span>._mmio_callbacks[rng]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mem_protect</span>(<span class="params">self, address: <span class="built_in">int</span>, size: <span class="built_in">int</span>, perms: <span class="built_in">int</span> = uc.UC_PROT_ALL</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Modify access protection bitmask of a mapped memory range.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            address : range base address</span></span><br><span class="line"><span class="string">            size    : range size (in bytes)</span></span><br><span class="line"><span class="string">            perms   : new access protection bitmask</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Raises: `UcError` in case access protection bitmask could not be changed</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">assert</span> (perms &amp; ~uc.UC_PROT_ALL) == <span class="number">0</span>, <span class="string">&#x27;unexpected perms bitmask&#x27;</span></span><br><span class="line"></span><br><span class="line">        status = uclib.uc_mem_protect(<span class="variable language_">self</span>._uch, address, size, perms)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> status != uc.UC_ERR_OK:</span><br><span class="line">            <span class="keyword">raise</span> UcError(status)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mmio_map</span>(<span class="params">self, address: <span class="built_in">int</span>, size: <span class="built_in">int</span>,</span></span><br><span class="line"><span class="params">            read_cb: <span class="type">Optional</span>[UC_MMIO_READ_TYPE], read_ud: <span class="type">Any</span>,</span></span><br><span class="line"><span class="params">            write_cb: <span class="type">Optional</span>[UC_MMIO_WRITE_TYPE], write_ud: <span class="type">Any</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Map an MMIO range. This method binds a memory range to read and write accessors</span></span><br><span class="line"><span class="string">        to simulate a hardware device. Unicorn does not allocate memory to back this range.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            address  : range base address</span></span><br><span class="line"><span class="string">            size     : range size (in bytes)</span></span><br><span class="line"><span class="string">            read_cb  : read callback to invoke upon read access. if not specified, reads \</span></span><br><span class="line"><span class="string">                       from the mmio range will be silently dropped</span></span><br><span class="line"><span class="string">            read_ud  : optional context object to pass on to the read callback</span></span><br><span class="line"><span class="string">            write_cb : write callback to invoke upon a write access. if not specified, writes \</span></span><br><span class="line"><span class="string">                       to the mmio range will be silently dropped</span></span><br><span class="line"><span class="string">            write_ud : optional context object to pass on to the write callback</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">        @uccallback(<span class="params">self, MMIO_READ_CFUNC</span>)</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">__mmio_map_read_cb</span>(<span class="params">uc: Uc, offset: <span class="built_in">int</span>, size: <span class="built_in">int</span>, key: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">            <span class="keyword">assert</span> read_cb <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> read_cb(uc, offset, size, read_ud)</span><br><span class="line"></span><br><span class="line"><span class="meta">        @uccallback(<span class="params">self, MMIO_WRITE_CFUNC</span>)</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">__mmio_map_write_cb</span>(<span class="params">uc: Uc, offset: <span class="built_in">int</span>, size: <span class="built_in">int</span>, value: <span class="built_in">int</span>, key: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">assert</span> write_cb <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">            write_cb(uc, offset, size, value, write_ud)</span><br><span class="line"></span><br><span class="line">        read_cb_fptr = read_cb <span class="keyword">and</span> __mmio_map_read_cb</span><br><span class="line">        write_cb_fptr = write_cb <span class="keyword">and</span> __mmio_map_write_cb</span><br><span class="line"></span><br><span class="line">        status = uclib.uc_mmio_map(<span class="variable language_">self</span>._uch, address, size, read_cb_fptr, <span class="number">0</span>, write_cb_fptr, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> status != uc.UC_ERR_OK:</span><br><span class="line">            <span class="keyword">raise</span> UcError(status)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># hold a reference to mmio callbacks</span></span><br><span class="line">        rng = (address, address + size)</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>._mmio_callbacks[rng] = (read_cb_fptr, write_cb_fptr)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mem_regions</span>(<span class="params">self</span>) -&gt; Iterator[<span class="type">Tuple</span>[<span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">int</span>]]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Iterate through mapped memory regions.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns: an iterator whose elements contain begin, end and perms  properties of each range</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Raises: `UcError` in case an internal error has been encountered</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        regions = ctypes.POINTER(uc_mem_region)()</span><br><span class="line">        count = ctypes.c_uint32()</span><br><span class="line">        status = uclib.uc_mem_regions(<span class="variable language_">self</span>._uch, ctypes.byref(regions), ctypes.byref(count))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> status != uc.UC_ERR_OK:</span><br><span class="line">            <span class="keyword">raise</span> UcError(status)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(count.value):</span><br><span class="line">                <span class="keyword">yield</span> regions[i].value</span><br><span class="line"></span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            uclib.uc_free(regions)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mem_read</span>(<span class="params">self, address: <span class="built_in">int</span>, size: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bytearray</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Read data from emulated memory subsystem.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            address : source memory location</span></span><br><span class="line"><span class="string">            size    : amount of bytes to read</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns: data bytes</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Raises: `UcError` in case of an invalid memory access</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        data = ctypes.create_string_buffer(size)</span><br><span class="line">        status = uclib.uc_mem_read(<span class="variable language_">self</span>._uch, address, data, size)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> status != uc.UC_ERR_OK:</span><br><span class="line">            <span class="keyword">raise</span> UcError(status, address, size)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytearray</span>(data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mem_write</span>(<span class="params">self, address: <span class="built_in">int</span>, data: <span class="built_in">bytes</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Write data to emulated memory subsystem.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            address : target memory location</span></span><br><span class="line"><span class="string">            data    : data bytes to write</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Raises: `UcError` in case of an invalid memory access</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        size = <span class="built_in">len</span>(data)</span><br><span class="line">        status = uclib.uc_mem_write(<span class="variable language_">self</span>._uch, address, data, size)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> status != uc.UC_ERR_OK:</span><br><span class="line">            <span class="keyword">raise</span> UcError(status, address, size)</span><br><span class="line"></span><br><span class="line">    <span class="comment">###########################</span></span><br><span class="line">    <span class="comment">#  Event hooks management #</span></span><br><span class="line">    <span class="comment">###########################</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__do_hook_add</span>(<span class="params">self, htype: <span class="built_in">int</span>, fptr: ctypes._FuncPointer, begin: <span class="built_in">int</span>, end: <span class="built_in">int</span>, *args: ctypes.c_int</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        handle = uc_hook_h()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># we do not need a callback counter to reference the callback and user data anymore,</span></span><br><span class="line">        <span class="comment"># so just pass a dummy value. that value will become the unused &#x27;key&#x27; argument</span></span><br><span class="line">        dummy = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        status = uclib.uc_hook_add(</span><br><span class="line">            <span class="variable language_">self</span>._uch,</span><br><span class="line">            ctypes.byref(handle),</span><br><span class="line">            htype,</span><br><span class="line">            fptr,</span><br><span class="line">            ctypes.cast(dummy, ctypes.c_void_p),</span><br><span class="line">            ctypes.c_uint64(begin),</span><br><span class="line">            ctypes.c_uint64(end),</span><br><span class="line">            *args</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> status != uc.UC_ERR_OK:</span><br><span class="line">            <span class="keyword">raise</span> UcError(status)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># hold a reference to the function pointer to prevent it from being gc-ed</span></span><br><span class="line">        <span class="variable language_">self</span>._callbacks[handle.value] = fptr</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> handle.value</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">hook_add</span>(<span class="params">self, htype: <span class="built_in">int</span>, callback: <span class="type">Callable</span>, user_data: <span class="type">Any</span> = <span class="literal">None</span>, begin: <span class="built_in">int</span> = <span class="number">1</span>, end: <span class="built_in">int</span> = <span class="number">0</span>, aux1: <span class="built_in">int</span> = <span class="number">0</span>, aux2: <span class="built_in">int</span> = <span class="number">0</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Hook emulated events of a certain type.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            htype     : event type(s) to hook (see UC_HOOK_* constants)</span></span><br><span class="line"><span class="string">            callback  : a method to call each time the hooked event occurs</span></span><br><span class="line"><span class="string">            user_data : an additional context to pass to the callback when it is called</span></span><br><span class="line"><span class="string">            begin     : address where hook scope starts</span></span><br><span class="line"><span class="string">            end       : address where hook scope ends</span></span><br><span class="line"><span class="string">            aux1      : auxiliary parameter; needed for some hook types</span></span><br><span class="line"><span class="string">            aux2      : auxiliary parameter; needed for some hook types</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns: hook handle</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Raises: `UcError` in case of an invalid htype value</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">__hook_intr</span>():</span><br><span class="line"><span class="meta">            @uccallback(<span class="params">self, HOOK_INTR_CFUNC</span>)</span></span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">__hook_intr_cb</span>(<span class="params">uc: Uc, intno: <span class="built_in">int</span>, key: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">                callback(uc, intno, user_data)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> (__hook_intr_cb,)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">__hook_insn</span>():</span><br><span class="line">            <span class="comment"># each arch is expected to overload hook_add and implement this handler on their own.</span></span><br><span class="line">            <span class="comment"># if we got here, it means this particular architecture does not support hooking any</span></span><br><span class="line">            <span class="comment"># instruction, and so we fail</span></span><br><span class="line">            <span class="keyword">raise</span> UcError(uc.UC_ERR_ARG)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">__hook_code</span>():</span><br><span class="line"><span class="meta">            @uccallback(<span class="params">self, HOOK_CODE_CFUNC</span>)</span></span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">__hook_code_cb</span>(<span class="params">uc: Uc, address: <span class="built_in">int</span>, size: <span class="built_in">int</span>, key: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">                callback(uc, address, size, user_data)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> (__hook_code_cb,)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">__hook_invalid_mem</span>():</span><br><span class="line"><span class="meta">            @uccallback(<span class="params">self, HOOK_MEM_INVALID_CFUNC</span>)</span></span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">__hook_mem_invalid_cb</span>(<span class="params">uc: Uc, access: <span class="built_in">int</span>, address: <span class="built_in">int</span>, size: <span class="built_in">int</span>, value: <span class="built_in">int</span>, key: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">                <span class="keyword">return</span> callback(uc, access, address, size, value, user_data)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> (__hook_mem_invalid_cb,)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">__hook_mem</span>():</span><br><span class="line"><span class="meta">            @uccallback(<span class="params">self, HOOK_MEM_ACCESS_CFUNC</span>)</span></span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">__hook_mem_access_cb</span>(<span class="params">uc: Uc, access: <span class="built_in">int</span>, address: <span class="built_in">int</span>, size: <span class="built_in">int</span>, value: <span class="built_in">int</span>, key: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">                callback(uc, access, address, size, value, user_data)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> (__hook_mem_access_cb,)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">__hook_invalid_insn</span>():</span><br><span class="line"><span class="meta">            @uccallback(<span class="params">self, HOOK_INSN_INVALID_CFUNC</span>)</span></span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">__hook_insn_invalid_cb</span>(<span class="params">uc: Uc, key: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">                <span class="keyword">return</span> callback(uc, user_data)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> (__hook_insn_invalid_cb,)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">__hook_edge_gen</span>():</span><br><span class="line"><span class="meta">            @uccallback(<span class="params">self, HOOK_EDGE_GEN_CFUNC</span>)</span></span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">__hook_edge_gen_cb</span>(<span class="params">uc: Uc, cur: ctypes._Pointer[uc_tb], prev: ctypes._Pointer[uc_tb], key: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">                callback(uc, cur.contents, prev.contents, user_data)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> (__hook_edge_gen_cb,)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">__hook_tcg_opcode</span>():</span><br><span class="line"><span class="meta">            @uccallback(<span class="params">self, HOOK_TCG_OPCODE_CFUNC</span>)</span></span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">__hook_tcg_op_cb</span>(<span class="params">uc: Uc, address: <span class="built_in">int</span>, arg1: <span class="built_in">int</span>, arg2: <span class="built_in">int</span>, size: <span class="built_in">int</span>, key: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">                callback(uc, address, arg1, arg2, size, user_data)</span><br><span class="line"></span><br><span class="line">            opcode = ctypes.c_uint64(aux1)</span><br><span class="line">            flags = ctypes.c_uint64(aux2)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> (__hook_tcg_op_cb, opcode, flags)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">__hook_tlb_fill</span>():</span><br><span class="line"><span class="meta">            @uccallback(<span class="params">self, HOOK_TLB_FILL_CFUNC</span>)</span></span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">__hook_tlb_fill_cb</span>(<span class="params">uc: Uc, vaddr: <span class="built_in">int</span>, access: <span class="built_in">int</span>, entry: ctypes._Pointer[uc_tlb_entry], key: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">                <span class="keyword">return</span> callback(uc, vaddr, access, entry.contents, user_data)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> (__hook_tlb_fill_cb,)</span><br><span class="line"></span><br><span class="line">        handlers: <span class="type">Dict</span>[<span class="built_in">int</span>, <span class="type">Callable</span>[[], <span class="type">Tuple</span>]] = &#123;</span><br><span class="line">            uc.UC_HOOK_INTR               : __hook_intr,</span><br><span class="line">            uc.UC_HOOK_INSN               : __hook_insn,</span><br><span class="line">            uc.UC_HOOK_CODE               : __hook_code,</span><br><span class="line">            uc.UC_HOOK_BLOCK              : __hook_code,</span><br><span class="line">            uc.UC_HOOK_MEM_READ_UNMAPPED  : __hook_invalid_mem,</span><br><span class="line">            uc.UC_HOOK_MEM_WRITE_UNMAPPED : __hook_invalid_mem,</span><br><span class="line">            uc.UC_HOOK_MEM_FETCH_UNMAPPED : __hook_invalid_mem,</span><br><span class="line">            uc.UC_HOOK_MEM_READ_PROT      : __hook_invalid_mem,</span><br><span class="line">            uc.UC_HOOK_MEM_WRITE_PROT     : __hook_invalid_mem,</span><br><span class="line">            uc.UC_HOOK_MEM_FETCH_PROT     : __hook_invalid_mem,</span><br><span class="line">            uc.UC_HOOK_MEM_READ           : __hook_mem,</span><br><span class="line">            uc.UC_HOOK_MEM_WRITE          : __hook_mem,</span><br><span class="line">            uc.UC_HOOK_MEM_FETCH          : __hook_mem,</span><br><span class="line">            <span class="comment"># uc.UC_HOOK_MEM_READ_AFTER</span></span><br><span class="line">            uc.UC_HOOK_INSN_INVALID       : __hook_invalid_insn,</span><br><span class="line">            uc.UC_HOOK_EDGE_GENERATED     : __hook_edge_gen,</span><br><span class="line">            uc.UC_HOOK_TCG_OPCODE         : __hook_tcg_opcode,</span><br><span class="line">            uc.UC_HOOK_TLB_FILL           : __hook_tlb_fill</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># the same callback may be registered for multiple hook types if they</span></span><br><span class="line">        <span class="comment"># share the same handling method. here we iterate through htype set bits</span></span><br><span class="line">        <span class="comment"># and collect all unique handlers it refers to (no duplicates)</span></span><br><span class="line">        matched = <span class="built_in">set</span>(handlers.get(<span class="number">1</span> &lt;&lt; n) <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>) <span class="keyword">if</span> htype &amp; (<span class="number">1</span> &lt;&lt; n))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># the set of matched handlers is expected to include exactly one element.</span></span><br><span class="line">        <span class="comment"># more than one member indicates that htype refers to more than one handler</span></span><br><span class="line">        <span class="comment"># at the same time, whereas callbacks cannot be assigned to different handlers.</span></span><br><span class="line">        <span class="comment"># an empty set indicates a matching handler was not found, probably due to</span></span><br><span class="line">        <span class="comment"># an invalid htype value</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(matched) != <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">raise</span> UcError(uc.UC_ERR_ARG)</span><br><span class="line"></span><br><span class="line">        handler = matched.pop()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># a None element indicates that htype has an unrecognized bit set</span></span><br><span class="line">        <span class="keyword">if</span> handler <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">raise</span> UcError(uc.UC_ERR_ARG)</span><br><span class="line"></span><br><span class="line">        fptr, *aux = handler()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.__do_hook_add(htype, fptr, begin, end, *aux)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">hook_del</span>(<span class="params">self, handle: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Remove an existing hook.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            handle: hook handle</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        h = uc_hook_h(handle)</span><br><span class="line">        status = uclib.uc_hook_del(<span class="variable language_">self</span>._uch, h)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> status != uc.UC_ERR_OK:</span><br><span class="line">            <span class="keyword">raise</span> UcError(status)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">del</span> <span class="variable language_">self</span>._callbacks[handle]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">query</span>(<span class="params">self, prop: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Query an internal Unicorn property.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            prop: property identifier (see: UC_QUERY_* constants)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns: property value</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        result = ctypes.c_size_t()</span><br><span class="line">        status = uclib.uc_query(<span class="variable language_">self</span>._uch, prop, ctypes.byref(result))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> status != uc.UC_ERR_OK:</span><br><span class="line">            <span class="keyword">raise</span> UcError(status, prop)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result.value</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">context_save</span>(<span class="params">self</span>) -&gt; UcContext:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Save Unicorn instance internal context.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns: unicorn context instance</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        context = UcContext(<span class="variable language_">self</span>._uch, <span class="variable language_">self</span>._arch, <span class="variable language_">self</span>._mode)</span><br><span class="line">        status = uclib.uc_context_save(<span class="variable language_">self</span>._uch, context.context)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> status != uc.UC_ERR_OK:</span><br><span class="line">            <span class="keyword">raise</span> UcError(status)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> context</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">context_update</span>(<span class="params">self, context: UcContext</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Update Unicorn instance internal context.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            context : unicorn context instance to copy data from</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        status = uclib.uc_context_save(<span class="variable language_">self</span>._uch, context.context)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> status != uc.UC_ERR_OK:</span><br><span class="line">            <span class="keyword">raise</span> UcError(status)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">context_restore</span>(<span class="params">self, context: UcContext</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Overwrite Unicorn instance internal context.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            context : unicorn context instance to copy data from</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        status = uclib.uc_context_restore(<span class="variable language_">self</span>._uch, context.context)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> status != uc.UC_ERR_OK:</span><br><span class="line">            <span class="keyword">raise</span> UcError(status)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__ctl_encode</span>(<span class="params">ctl: <span class="built_in">int</span>, op: <span class="built_in">int</span>, nargs: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">assert</span> check_maxbits(nargs, <span class="number">4</span>), <span class="string">f&#x27;nargs must not exceed value of 15 (got <span class="subst">&#123;nargs&#125;</span>)&#x27;</span></span><br><span class="line">        <span class="keyword">assert</span> op <span class="keyword">and</span> check_maxbits(op, <span class="number">2</span>), <span class="string">f&#x27;op must not exceed value of 3 (got <span class="subst">&#123;op&#125;</span>)&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (op &lt;&lt; <span class="number">30</span>) | (nargs &lt;&lt; <span class="number">26</span>) | ctl</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ctl</span>(<span class="params">self, ctl: <span class="built_in">int</span>, op: <span class="built_in">int</span>, *args</span>):</span><br><span class="line">        code = Uc.__ctl_encode(ctl, op, <span class="built_in">len</span>(args))</span><br><span class="line"></span><br><span class="line">        status = uclib.uc_ctl(<span class="variable language_">self</span>._uch, code, *args)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> status != uc.UC_ERR_OK:</span><br><span class="line">            <span class="keyword">raise</span> UcError(status)</span><br><span class="line"></span><br><span class="line">    Arg = <span class="type">Tuple</span>[<span class="type">Type</span>, <span class="type">Optional</span>[<span class="built_in">int</span>]]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__ctl_r</span>(<span class="params">self, ctl: <span class="built_in">int</span>, arg0: Arg</span>):</span><br><span class="line">        atype, _ = arg0</span><br><span class="line">        carg = atype()</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.ctl(ctl, uc.UC_CTL_IO_READ, ctypes.byref(carg))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> carg.value</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__ctl_w</span>(<span class="params">self, ctl: <span class="built_in">int</span>, *args: Arg</span>):</span><br><span class="line">        cargs = (atype(avalue) <span class="keyword">for</span> atype, avalue <span class="keyword">in</span> args)</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.ctl(ctl, uc.UC_CTL_IO_WRITE, *cargs)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__ctl_wr</span>(<span class="params">self, ctl: <span class="built_in">int</span>, arg0: Arg, arg1: Arg</span>):</span><br><span class="line">        atype, avalue = arg0</span><br><span class="line">        carg0 = atype(avalue)</span><br><span class="line"></span><br><span class="line">        atype, _ = arg1</span><br><span class="line">        carg1 = atype()</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.ctl(ctl, uc.UC_CTL_IO_READ_WRITE, carg0, ctypes.byref(carg1))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> carg1.value</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ctl_get_mode</span>(<span class="params">self</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Retrieve current processor mode.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns: current mode (see UC_MODE_* constants)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.__ctl_r(uc.UC_CTL_UC_MODE,</span><br><span class="line">            (ctypes.c_int, <span class="literal">None</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ctl_get_page_size</span>(<span class="params">self</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Retrieve target page size.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns: page size in bytes</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.__ctl_r(uc.UC_CTL_UC_PAGE_SIZE,</span><br><span class="line">            (ctypes.c_uint32, <span class="literal">None</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ctl_set_page_size</span>(<span class="params">self, val: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Set target page size.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            val: page size to set (in bytes)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Raises: `UcError` in any of the following cases:</span></span><br><span class="line"><span class="string">          - Unicorn architecture is not ARM</span></span><br><span class="line"><span class="string">          - Unicorn has already completed its initialization</span></span><br><span class="line"><span class="string">          - Page size is not a power of 2</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.__ctl_w(uc.UC_CTL_UC_PAGE_SIZE,</span><br><span class="line">            (ctypes.c_uint32, val)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ctl_get_arch</span>(<span class="params">self</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Retrieve target architecture.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns: current architecture (see UC_ARCH_* constants)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.__ctl_r(uc.UC_CTL_UC_ARCH,</span><br><span class="line">            (ctypes.c_int, <span class="literal">None</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ctl_get_timeout</span>(<span class="params">self</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Retrieve emulation timeout.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns: timeout value set on emulation start</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.__ctl_r(uc.UC_CTL_UC_TIMEOUT,</span><br><span class="line">            (ctypes.c_uint64, <span class="literal">None</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ctl_exits_enabled</span>(<span class="params">self, enable: <span class="built_in">bool</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Instruct Unicorn whether to respect emulation exit points or ignore them.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            enable: `True` to enable exit points, `False` to ignore them</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.__ctl_w(uc.UC_CTL_UC_USE_EXITS,</span><br><span class="line">            (ctypes.c_int, enable)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ctl_get_exits_cnt</span>(<span class="params">self</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Retrieve emulation exit points count.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns: number of emulation exit points</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Raises: `UcErro` if Unicorn is set to ignore exits</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.__ctl_r(uc.UC_CTL_UC_EXITS_CNT,</span><br><span class="line">            (ctypes.c_size_t, <span class="literal">None</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ctl_get_exits</span>(<span class="params">self</span>) -&gt; <span class="type">Sequence</span>[<span class="built_in">int</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Retrieve emulation exit points.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns: a tuple of all emulation exit points</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Raises: `UcErro` if Unicorn is set to ignore exits</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        count = <span class="variable language_">self</span>.ctl_get_exits_cnt()</span><br><span class="line">        arr = (ctypes.c_uint64 * count)()</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.ctl(uc.UC_CTL_UC_EXITS, uc.UC_CTL_IO_READ, ctypes.cast(arr, ctypes.c_void_p), ctypes.c_size_t(count))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">tuple</span>(arr)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ctl_set_exits</span>(<span class="params">self, exits: <span class="type">Sequence</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Set emulation exit points.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            exits: a list of emulation exit points to set</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Raises: `UcErro` if Unicorn is set to ignore exits</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        arr = (ctypes.c_uint64 * <span class="built_in">len</span>(exits))(*exits)</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.ctl(uc.UC_CTL_UC_EXITS, uc.UC_CTL_IO_WRITE, ctypes.cast(arr, ctypes.c_void_p), ctypes.c_size_t(<span class="built_in">len</span>(arr)))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ctl_get_cpu_model</span>(<span class="params">self</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Retrieve target processor model.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns: target cpu model (see UC_CPU_* constants)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.__ctl_r(uc.UC_CTL_CPU_MODEL,</span><br><span class="line">            (ctypes.c_int, <span class="literal">None</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ctl_set_cpu_model</span>(<span class="params">self, model: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Set target processor model.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            model: cpu model to set (see UC_CPU_* constants)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Raises: `UcError` in any of the following cases:</span></span><br><span class="line"><span class="string">          - `model` is not a valid cpu model</span></span><br><span class="line"><span class="string">          - Requested cpu model is incompatible with current mode</span></span><br><span class="line"><span class="string">          - Unicorn has already completed its initialization</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.__ctl_w(uc.UC_CTL_CPU_MODEL,</span><br><span class="line">            (ctypes.c_int, model)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ctl_remove_cache</span>(<span class="params">self, lbound: <span class="built_in">int</span>, ubound: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Invalidate translation cache for a specified region.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            lbound: region lower bound</span></span><br><span class="line"><span class="string">            ubound: region upper bound</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Raises: `UcError` in case the provided range bounds are invalid</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.__ctl_w(uc.UC_CTL_TB_REMOVE_CACHE,</span><br><span class="line">            (ctypes.c_uint64, lbound),</span><br><span class="line">            (ctypes.c_uint64, ubound)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ctl_request_cache</span>(<span class="params">self, addr: <span class="built_in">int</span></span>) -&gt; TBStruct:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Get translation cache info for a specified address.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            addr: address to get its translation cache info</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns: a 3-tuple containing the base address, instructions count and</span></span><br><span class="line"><span class="string">                size of the translation block containing the specified address</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.__ctl_wr(uc.UC_CTL_TB_REQUEST_CACHE,</span><br><span class="line">            (ctypes.c_uint64, addr),</span><br><span class="line">            (uc_tb, <span class="literal">None</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ctl_flush_tb</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Flush the entire translation cache.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.__ctl_w(uc.UC_CTL_TB_FLUSH)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ctl_set_tlb_mode</span>(<span class="params">self, mode: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Set TLB mode.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            mode: tlb mode to use (see UC_TLB_* constants)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.__ctl_w(uc.UC_CTL_TLB_TYPE,</span><br><span class="line">            (ctypes.c_uint, mode)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="comment"># For backward compatibility...</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ctl_tlb_mode</span>(<span class="params">self, mode: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Deprecated, please use ctl_set_tlb_mode instead.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            mode: tlb mode to use (see UC_TLB_* constants)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        warnings.warn(<span class="string">&#x27;Deprecated method, use ctl_set_tlb_mode&#x27;</span>, DeprecationWarning)</span><br><span class="line">        <span class="variable language_">self</span>.ctl_set_tlb_mode(mode)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ctl_get_tcg_buffer_size</span>(<span class="params">self</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Retrieve TCG buffer size.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns: buffer size (in bytes)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.__ctl_r(uc.UC_CTL_TCG_BUFFER_SIZE,</span><br><span class="line">            (ctypes.c_uint32, <span class="literal">None</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ctl_set_tcg_buffer_size</span>(<span class="params">self, size: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Set TCG buffer size.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            size: new size to set</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.__ctl_w(uc.UC_CTL_TCG_BUFFER_SIZE,</span><br><span class="line">            (ctypes.c_uint32, size)</span><br><span class="line">        )</span><br></pre></td></tr></table></figure>
<p>m方法：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Source for m</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">methodcaller</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Return a callable object that calls the given method on its operand.</span></span><br><span class="line"><span class="string">    After f = methodcaller(&#x27;name&#x27;), the call f(r) returns r.name().</span></span><br><span class="line"><span class="string">    After g = methodcaller(&#x27;name&#x27;, &#x27;date&#x27;, foo=1), the call g(r) returns</span></span><br><span class="line"><span class="string">    r.name(&#x27;date&#x27;, foo=1).</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    __slots__ = (<span class="string">&#x27;_name&#x27;</span>, <span class="string">&#x27;_args&#x27;</span>, <span class="string">&#x27;_kwargs&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, /, *args, **kwargs</span>):</span><br><span class="line">        <span class="variable language_">self</span>._name = name</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(<span class="variable language_">self</span>._name, <span class="built_in">str</span>):</span><br><span class="line">            <span class="keyword">raise</span> TypeError(<span class="string">&#x27;method name must be a string&#x27;</span>)</span><br><span class="line">        <span class="variable language_">self</span>._args = args</span><br><span class="line">        <span class="variable language_">self</span>._kwargs = kwargs</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self, obj</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">getattr</span>(obj, <span class="variable language_">self</span>._name)(*<span class="variable language_">self</span>._args, **<span class="variable language_">self</span>._kwargs)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        args = [<span class="built_in">repr</span>(<span class="variable language_">self</span>._name)]</span><br><span class="line">        args.extend(<span class="built_in">map</span>(<span class="built_in">repr</span>, <span class="variable language_">self</span>._args))</span><br><span class="line">        args.extend(<span class="string">&#x27;%s=%r&#x27;</span> % (k, v) <span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="variable language_">self</span>._kwargs.items())</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;%s.%s(%s)&#x27;</span> % (<span class="variable language_">self</span>.__class__.__module__,</span><br><span class="line">                              <span class="variable language_">self</span>.__class__.__name__,</span><br><span class="line">                              <span class="string">&#x27;, &#x27;</span>.join(args))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>._kwargs:</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>.__class__, (<span class="variable language_">self</span>._name,) + <span class="variable language_">self</span>._args</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">from</span> functools <span class="keyword">import</span> partial</span><br><span class="line">            <span class="keyword">return</span> partial(<span class="variable language_">self</span>.__class__, <span class="variable language_">self</span>._name, **<span class="variable language_">self</span>._kwargs), <span class="variable language_">self</span>._args</span><br></pre></td></tr></table></figure>
<p>其他的cpython编译的源码虽然看不到，但我们可以看它其他的信息</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;__builtins__&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;module&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;signature&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;doc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Built-in functions, exceptions, and other objects.\n\nNoteworthy: None is the `nil&#x27; object; Ellipsis represents `...&#x27; in slices.&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_saved&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;note&quot;</span><span class="punctuation">:</span> <span class="string">&quot;无法获取源码: TypeError: &lt;module &#x27;builtins&#x27; (built-in)&gt; is a built-in module&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;__doc__&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;NoneType&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;signature&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;doc&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_saved&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;note&quot;</span><span class="punctuation">:</span> <span class="string">&quot;无法获取源码: TypeError: module, class, method, function, traceback, frame, or code object was expected, got NoneType&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;__file__&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;str&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;signature&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;doc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;str(object=&#x27;&#x27;) -&gt; str\nstr(bytes_or_buffer[, encoding[, errors]]) -&gt; str\n\nCreate a new string object from the given object. If encoding or\nerrors is specified, then the object must expose a data buffer...\n[文档省略]&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_saved&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;note&quot;</span><span class="punctuation">:</span> <span class="string">&quot;无法获取源码: TypeError: module, class, method, function, traceback, frame, or code object was expected, got str&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;__loader__&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ExtensionFileLoader&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;signature&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;doc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Loader for extension modules.\n\nThe constructor is designed to work with FileFinder.&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_saved&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;note&quot;</span><span class="punctuation">:</span> <span class="string">&quot;无法获取源码: TypeError: module, class, method, function, traceback, frame, or code object was expected, got ExtensionFileLoader&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;__name__&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;str&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;signature&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;doc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;str(object=&#x27;&#x27;) -&gt; str\nstr(bytes_or_buffer[, encoding[, errors]]) -&gt; str\n\nCreate a new string object from the given object. If encoding or\nerrors is specified, then the object must expose a data buffer...\n[文档省略]&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_saved&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;note&quot;</span><span class="punctuation">:</span> <span class="string">&quot;无法获取源码: TypeError: module, class, method, function, traceback, frame, or code object was expected, got str&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;__package__&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;str&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;signature&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;doc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;str(object=&#x27;&#x27;) -&gt; str\nstr(bytes_or_buffer[, encoding[, errors]]) -&gt; str\n\nCreate a new string object from the given object. If encoding or\nerrors is specified, then the object must expose a data buffer...\n[文档省略]&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_saved&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;note&quot;</span><span class="punctuation">:</span> <span class="string">&quot;无法获取源码: TypeError: module, class, method, function, traceback, frame, or code object was expected, got str&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;__spec__&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ModuleSpec&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;signature&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;doc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;The specification for a module, used for loading.\n\nA module&#x27;s spec is the source for information about the module.  For\ndata associated with the module, including source, use the spec&#x27;s\nloader.\n\n`name...\n[文档省略]&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_saved&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;note&quot;</span><span class="punctuation">:</span> <span class="string">&quot;无法获取源码: TypeError: module, class, method, function, traceback, frame, or code object was expected, got ModuleSpec&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;__test__&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;dict&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;signature&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;doc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;dict() -&gt; new empty dictionary\ndict(mapping) -&gt; new dictionary initialized from a mapping object&#x27;s\n    (key, value) pairs\ndict(iterable) -&gt; new dictionary initialized as if via:\n    d = &#123;&#125;\n    for k, ...\n[文档省略]&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_saved&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;note&quot;</span><span class="punctuation">:</span> <span class="string">&quot;无法获取源码: TypeError: module, class, method, function, traceback, frame, or code object was expected, got dict&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;a2b_hex&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;builtin_function_or_method&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;signature&quot;</span><span class="punctuation">:</span> <span class="string">&quot;(hexstr, /)&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;doc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Binary data of hexadecimal representation.\n\nhexstr must contain an even number of hex digits (upper or lower case).\nThis function is also available as \&quot;unhexlify()\&quot;.&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_saved&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;note&quot;</span><span class="punctuation">:</span> <span class="string">&quot;无法获取源码: TypeError: module, class, method, function, traceback, frame, or code object was expected, got builtin_function_or_method&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;b&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;function&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;signature&quot;</span><span class="punctuation">:</span> <span class="string">&quot;(s, altchars=None)&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;file&quot;</span><span class="punctuation">:</span> <span class="string">&quot;D:\\anaconda\\envs\\py39\\lib\\base64.py&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;doc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Encode the bytes-like object s using Base64 and return a bytes object.\n\nOptional altchars should be a byte string of length 2 which specifies an\nalternative alphabet for the &#x27;+&#x27; and &#x27;/&#x27; characters.  T...\n[文档省略]&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_saved&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_file&quot;</span><span class="punctuation">:</span> <span class="string">&quot;init_source\\b.py&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;note&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;type&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;signature&quot;</span><span class="punctuation">:</span> <span class="string">&quot;(arch: &#x27;int&#x27;, mode: &#x27;int&#x27;, cpu: &#x27;Optional[int]&#x27; = None)&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;file&quot;</span><span class="punctuation">:</span> <span class="string">&quot;D:\\anaconda\\envs\\py39\\lib\\site-packages\\unicorn\\unicorn_py3\\unicorn.py&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;doc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Unicorn Engine class.&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_saved&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_file&quot;</span><span class="punctuation">:</span> <span class="string">&quot;init_source\\c.py&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;note&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;e&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;UcIntel&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;signature&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;doc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Unicorn subclass for Intel architecture.&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_saved&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;note&quot;</span><span class="punctuation">:</span> <span class="string">&quot;无法获取源码: TypeError: module, class, method, function, traceback, frame, or code object was expected, got UcIntel&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;exec&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cython_function_or_method&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;signature&quot;</span><span class="punctuation">:</span> <span class="string">&quot;(x)&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;doc&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_saved&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;note&quot;</span><span class="punctuation">:</span> <span class="string">&quot;无法获取源码: TypeError: module, class, method, function, traceback, frame, or code object was expected, got cython_function_or_method&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;exit&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;builtin_function_or_method&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;signature&quot;</span><span class="punctuation">:</span> <span class="string">&quot;(source, globals=None, locals=None, /)&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;doc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Evaluate the given source in the context of globals and locals.\n\nThe source may be a string representing a Python expression\nor a code object as returned by compile().\nThe globals must be a dictionary...\n[文档省略]&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_saved&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;note&quot;</span><span class="punctuation">:</span> <span class="string">&quot;无法获取源码: TypeError: module, class, method, function, traceback, frame, or code object was expected, got builtin_function_or_method&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;i&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;builtin_function_or_method&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;signature&quot;</span><span class="punctuation">:</span> <span class="string">&quot;(prompt=None, /)&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;doc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Read a string from standard input.  The trailing newline is stripped.\n\nThe prompt string, if given, is printed to standard output without a\ntrailing newline before reading input.\n\nIf the user hits EOF...\n[文档省略]&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_saved&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;note&quot;</span><span class="punctuation">:</span> <span class="string">&quot;无法获取源码: TypeError: module, class, method, function, traceback, frame, or code object was expected, got builtin_function_or_method&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;type&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;signature&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&lt;签名不可用: no signature found for builtin type &lt;class &#x27;str&#x27;&gt;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;doc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;str(object=&#x27;&#x27;) -&gt; str\nstr(bytes_or_buffer[, encoding[, errors]]) -&gt; str\n\nCreate a new string object from the given object. If encoding or\nerrors is specified, then the object must expose a data buffer...\n[文档省略]&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_saved&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;note&quot;</span><span class="punctuation">:</span> <span class="string">&quot;无法获取源码: TypeError: &lt;class &#x27;str&#x27;&gt; is a built-in class&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;m&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;type&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;signature&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&lt;签名不可用: no signature found for builtin type &lt;class &#x27;operator.methodcaller&#x27;&gt;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;file&quot;</span><span class="punctuation">:</span> <span class="string">&quot;D:\\anaconda\\envs\\py39\\lib\\operator.py&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;doc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;methodcaller(name, ...) --&gt; methodcaller object\n\nReturn a callable object that calls the given method on its operand.\nAfter f = methodcaller(&#x27;name&#x27;), the call f(r) returns r.name().\nAfter g = methodca...\n[文档省略]&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_saved&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_file&quot;</span><span class="punctuation">:</span> <span class="string">&quot;init_source\\m.py&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;note&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;p&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;builtin_function_or_method&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;signature&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&lt;签名不可用: no signature found for builtin &lt;built-in function print&gt;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;doc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;print(value, ..., sep=&#x27; &#x27;, end=&#x27;\\n&#x27;, file=sys.stdout, flush=False)\n\nPrints the values to a stream, or to sys.stdout by default.\nOptional keyword arguments:\nfile:  a file-like object (stream); defaults...\n[文档省略]&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_saved&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source_file&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;note&quot;</span><span class="punctuation">:</span> <span class="string">&quot;无法获取源码: TypeError: module, class, method, function, traceback, frame, or code object was expected, got builtin_function_or_method&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<p>比如说可以看到p是print()，i是input()等等</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>名称</th>
<th>实际对象</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>a2b_hex</strong></td>
<td>built-in</td>
<td>用于十六进制转字节。无关。</td>
</tr>
<tr>
<td><strong>b</strong></td>
<td><code>base64.b64encode</code></td>
<td>Base64 编码函数。</td>
</tr>
<tr>
<td><strong>c</strong></td>
<td><code>unicorn.Uc</code></td>
<td>模拟器类。</td>
</tr>
<tr>
<td><strong>e</strong></td>
<td><code>UcIntel()</code></td>
<td>模拟器实例。</td>
</tr>
<tr>
<td><strong>exec</strong></td>
<td>自定义（Cython 实现）</td>
<td>类似 <code>exec()</code> 执行字符串代码。</td>
</tr>
<tr>
<td><strong>exit</strong></td>
<td>其实是 Python 内置 <code>eval()</code>（看 doc）</td>
<td>所以 <code>exit(&quot;1+2&quot;) == eval(&quot;1+2&quot;)</code>。</td>
</tr>
<tr>
<td><strong>i</strong></td>
<td><code>input()</code></td>
<td>读取输入。</td>
</tr>
<tr>
<td><strong>int</strong></td>
<td>实际是 <strong><code>str()</code></strong>（伪装成 int）</td>
<td>所以 <code>int(30)</code> 返回 <code>&#39;30&#39;</code>！</td>
</tr>
<tr>
<td><strong>m</strong></td>
<td><code>operator.methodcaller</code></td>
<td>调用某个对象的方法的工厂函数。</td>
</tr>
<tr>
<td><strong>p</strong></td>
<td><code>print()</code></td>
<td>打印函数。</td>
</tr>
</tbody>
</table>
</div>
<h2 id="简化："><a href="#简化：" class="headerlink" title="简化："></a>简化：</h2><p>现在把这些扔给ai用正则表达式对plus.py简化</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deobfuscated / formatted (text-only transform)</span></span><br><span class="line"><span class="comment"># Mappings:</span></span><br><span class="line"><span class="comment"># m -&gt; operator.methodcaller</span></span><br><span class="line"><span class="comment"># b -&gt; base64.b64encode (b)</span></span><br><span class="line"><span class="comment"># c -&gt; unicorn.Uc</span></span><br><span class="line"><span class="comment"># e -&gt; unicorn instance (uc)</span></span><br><span class="line"><span class="comment"># exec -&gt; exec-like function (kept as exec placeholder)</span></span><br><span class="line"><span class="comment"># exit -&gt; converted by concatenating int(...) digits into integer literal</span></span><br><span class="line"><span class="comment"># i -&gt; input</span></span><br><span class="line"><span class="comment"># int -&gt; behaves as str(...) in init, replaced accordingly</span></span><br><span class="line"><span class="comment"># p -&gt; print</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="keyword">from</span> init <span class="keyword">import</span> *;m(<span class="built_in">exec</span>(<span class="number">30792292888306032</span>), <span class="number">16777216</span>, <span class="number">2097152</span>)(e);</span><br><span class="line">m(<span class="built_in">exec</span>(<span class="number">30792292888306032</span>), <span class="number">18874368</span>, <span class="number">65536</span>)(e);</span><br><span class="line">m(<span class="built_in">exec</span>(<span class="number">2018003706771258569829</span>),<span class="number">16777216</span>,<span class="built_in">exec</span>(<span class="number">2154308209104587365050518702243508477825638429417674506.</span>.<span class="number">.60128987662749468317325542233718690074933730651941880380559453</span>),)(e);</span><br><span class="line">m(<span class="built_in">exec</span>(<span class="number">2110235738289946063973</span>), <span class="number">44</span>, <span class="number">18939903</span>)(e);</span><br><span class="line">m(<span class="built_in">exec</span>(<span class="number">2018003706771258569829</span>), <span class="number">18878464</span>, i(<span class="built_in">exec</span>(<span class="number">520485229507545392928716380743873332979750615584</span>)).encode())(e);</span><br><span class="line">m(<span class="built_in">exec</span>(<span class="number">2110235738289946063973</span>), <span class="number">39</span>, <span class="number">18878464</span>)(e);</span><br><span class="line">m(<span class="built_in">exec</span>(<span class="number">2110235738289946063973</span>), <span class="number">43</span>, <span class="number">44</span>)(e);</span><br><span class="line">m(<span class="built_in">exec</span>(<span class="number">2110235738289946063973</span>), <span class="number">40</span>, <span class="number">7</span>)(e);</span><br><span class="line">m(<span class="built_in">exec</span>(<span class="number">18710084667165524261000</span>), <span class="number">16777216</span>, <span class="number">16777332</span>)(e);</span><br><span class="line">p(<span class="built_in">exec</span>(<span class="number">17353562600</span>)) <span class="keyword">if</span> (b(m(<span class="built_in">exec</span>(<span class="number">7882826979490488676</span>), <span class="number">18878464</span>, <span class="number">44</span>)(e))</span><br><span class="line">.decode()== <span class="built_in">exec</span>(<span class="number">63649679746492988981901858995847426189422638088.</span>.<span class="number">.77866432975817021</span>)) <span class="keyword">else</span> p(<span class="built_in">exec</span>(<span class="number">31084432670685473</span>)) <span class="comment">#type:ignore</span></span><br></pre></td></tr></table></figure>
<p>由于<code>methodcaller()</code> 的第一个参数必须是字符串，说明 <code>exec()</code> 方法是一个把 “int” 转 “str” 的方法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(py39) C:\Users\Lenovo\OneDrive\Desktop\chal&gt;python</span><br><span class="line">Python 3.9.23 | packaged by conda-forge | (main, Jun  4 2025, 17:49:16) [MSC v.1929 64 bit (AMD64)] on win32</span><br><span class="line">Type <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> or <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; import init</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span>(init.exec(7882826979490488676))</span><br><span class="line">mem_read</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>继续替换：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># plus.exec.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> methodcaller</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> unicorn <span class="keyword">import</span> Uc, UC_ARCH_X86, UC_MODE_64</span><br><span class="line"></span><br><span class="line">e = Uc(UC_ARCH_X86, UC_MODE_64)</span><br><span class="line"></span><br><span class="line">methodcaller(<span class="string">&quot;mem_map&quot;</span>, <span class="number">16777216</span>, <span class="number">2097152</span>)(e)</span><br><span class="line"></span><br><span class="line">methodcaller(<span class="string">&quot;mem_map&quot;</span>, <span class="number">18874368</span>, <span class="number">65536</span>)(e)</span><br><span class="line"></span><br><span class="line">methodcaller(<span class="string">&quot;mem_write&quot;</span>, <span class="number">16777216</span>, </span><br><span class="line"><span class="string">b&quot;\xf3\x0f\x1e\xfaUH\x89\xe5H\x89&#125;\xe8\x89u\xe4\x89\xd0\x88E\xe0\xc7E\xfc\x00\x00\x00\x00\xebL\x8bU\xfcH\x8bE\xe8H\x01\xd0\x0f\xb6\x00\x8d\x0c\xc5\x00\x00\x00\x00\x8bU\xfcH\x8bE\xe8H\x01\xd0\x0f\xb6\x002E\xe0\x8d4\x01\x8bU\xfcH\x8bE\xe8H\x01\xd0\x0f\xb6\x00\xc1\xe0\x05\x89\xc1\x8bU\xfcH\x8bE\xe8H\x01\xd0\x8d\x14\x0e\x88\x10\x83E\xfc\x01\x8bE\xfc;E\xe4r\xac\x90\x90]&quot;</span>,</span><br><span class="line">)(e)</span><br><span class="line"></span><br><span class="line">methodcaller(<span class="string">&quot;reg_write&quot;</span>, <span class="number">44</span>, <span class="number">18939903</span>)(e)</span><br><span class="line"></span><br><span class="line">methodcaller(<span class="string">&quot;mem_write&quot;</span>, <span class="number">18878464</span>, <span class="built_in">input</span>(<span class="string">&quot;[+]input your flag: &quot;</span>).encode())(e)</span><br><span class="line"></span><br><span class="line">methodcaller(<span class="string">&quot;reg_write&quot;</span>, <span class="number">39</span>, <span class="number">18878464</span>)(e)</span><br><span class="line"></span><br><span class="line">methodcaller(<span class="string">&quot;reg_write&quot;</span>, <span class="number">43</span>, <span class="number">44</span>)(e)</span><br><span class="line"></span><br><span class="line">methodcaller(<span class="string">&quot;reg_write&quot;</span>, <span class="number">40</span>, <span class="number">7</span>)(e)</span><br><span class="line"></span><br><span class="line">methodcaller(<span class="string">&quot;emu_start&quot;</span>, <span class="number">16777216</span>, <span class="number">16777332</span>)(e)</span><br><span class="line"></span><br><span class="line">(</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;good&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> (</span><br><span class="line">        base64.b64encode(e.mem_read(<span class="number">18878464</span>, <span class="number">44</span>)).decode() == <span class="string">&quot;425MvHMxtLqZ3ty3RZkw3mwwulNRjkswbpkDMK+3CDCOtbe6kzAqPyrcEAI=&quot;</span></span><br><span class="line">    )</span><br><span class="line">elseprint(<span class="string">&quot;no way!&quot;</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>再把methodcaller去了</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># plus.exec.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> unicorn <span class="keyword">import</span> Uc, UC_ARCH_X86, UC_MODE_64</span><br><span class="line"></span><br><span class="line">e = Uc(UC_ARCH_X86, UC_MODE_64) <span class="comment">#说明：用 Unicorn 创建 x86_64 的仿真器实例 e。</span></span><br><span class="line">e.mem_map(<span class="number">16777216</span>, <span class="number">2097152</span>)</span><br><span class="line">e.mem_map(<span class="number">18874368</span>, <span class="number">65536</span>) <span class="comment">#说明：在虚拟地址 0x1000000（16777216）和 0x1200000（18874368）分别映射一段内存，长度分别是 0x200000（2097152）和 0x10000（65536）。这些是写入 shellcode/数据和 flag 的内存区域。</span></span><br><span class="line">e.mem_write(<span class="number">16777216</span>, <span class="string">b&quot;\xf3\x0f\x1e\xfaUH\x89\xe5H\x89&#125;\xe8\x89u\xe4\x89\xd0\x88E\xe0\xc7E\xfc\x00\x00\x00\x00\xebL\x8bU\xfcH\x8bE\xe8H\x01\xd0\x0f\xb6\x00\x8d\x0c\xc5\x00\x00\x00\x00\x8bU\xfcH\x8bE\xe8H\x01\xd0\x0f\xb6\x002E\xe0\x8d4\x01\x8bU\xfcH\x8bE\xe8H\x01\xd0\x0f\xb6\x00\xc1\xe0\x05\x89\xc1\x8bU\xfcH\x8bE\xe8H\x01\xd0\x8d\x14\x0e\x88\x10\x83E\xfc\x01\x8bE\xfc;E\xe4r\xac\x90\x90]&quot;</span>)</span><br><span class="line"><span class="comment">#把一段“字节串”写到 0x1000000</span></span><br><span class="line">e.reg_write(<span class="number">44</span>, <span class="number">18939903</span>) <span class="comment">#把数值 18939903 写到寄存器编号 44</span></span><br><span class="line">e.mem_write(<span class="number">18878464</span>, <span class="built_in">input</span>(<span class="string">&quot;[+]input your flag: &quot;</span>).encode())</span><br><span class="line">e.reg_write(<span class="number">39</span>, <span class="number">18878464</span>) <span class="comment"># input</span></span><br><span class="line">e.reg_write(<span class="number">43</span>, <span class="number">44</span>) <span class="comment"># length</span></span><br><span class="line">e.reg_write(<span class="number">40</span>, <span class="number">7</span>) <span class="comment"># key  #把相关寄存器设置为相应地址/值（39、43、40 为寄存器 id）。</span></span><br><span class="line">e.emu_start(<span class="number">16777216</span>, <span class="number">16777332</span>) <span class="comment">#从 0x1000000 执行到 0x1000000 + ?（结束地址 16777332），在这段内执行之前写入的 shellcode。</span></span><br><span class="line">(</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;good&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> (</span><br><span class="line">        base64.b64encode(e.mem_read(<span class="number">18878464</span>, <span class="number">44</span>)).decode() == <span class="string">&quot;425MvHMxtLqZ3ty3RZkw3mwwulNRjkswbpkDMK+3CDCOtbe6kzAqPyrcEAI=&quot;</span></span><br><span class="line">    )</span><br><span class="line">elseprint(<span class="string">&quot;no way!&quot;</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>现在分析那段字节串代表的指令：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data = <span class="string">b&quot;\xf3\x0f\x1e\xfaUH\x89\xe5H\x89&#125;\xe8\x89u\xe4\x89\xd0\x88E\xe0\xc7E\xfc\x00\x00\x00\x00\xebL\x8bU\xfcH\x8bE\xe8H\x01\xd0\x0f\xb6\x00\x8d\x0c\xc5\x00\x00\x00\x00\x8bU\xfcH\x8bE\xe8H\x01\xd0\x0f\xb6\x002E\xe0\x8d4\x01\x8bU\xfcH\x8bE\xe8H\x01\xd0\x0f\xb6\x00\xc1\xe0\x05\x89\xc1\x8bU\xfcH\x8bE\xe8H\x01\xd0\x8d\x14\x0e\x88\x10\x83E\xfc\x01\x8bE\xfc;E\xe4r\xac\x90\x90&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;C:\Users\Lenovo\OneDrive\Desktop\chal\code.bin&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(data)</span><br></pre></td></tr></table></figure>
<p>然后用ida打开这个code.bin就可以看到反汇编逻辑了</p>
<p><img data-src="/images/逆向中的misc/py/pyd逆向.png" alt="pyd逆向"></p>
<h2 id="获取函数参数"><a href="#获取函数参数" class="headerlink" title="获取函数参数"></a>获取函数参数</h2><p>那怎么看这个反汇编传的参数都是什么呢？</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">e.reg_write(<span class="number">39</span>, <span class="number">18878464</span>) <span class="comment"># input</span></span><br><span class="line">e.reg_write(<span class="number">43</span>, <span class="number">44</span>) <span class="comment"># length</span></span><br><span class="line">e.reg_write(<span class="number">40</span>, <span class="number">7</span>) <span class="comment"># key  #把相关寄存器设置为相应地址/值（39、43、40 为寄存器 id）。</span></span><br></pre></td></tr></table></figure>
<p>这里它把对应寄存器编号赋值，我们可以打印一下这些编号对应寄存器</p>
<p>Unicorn 使用 <strong>统一的常量命名</strong>，<code>UC_X86_REG_*</code> 代表 x86/x86-64 的寄存器。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> unicorn.x86_const <span class="keyword">as</span> xc</span><br><span class="line"><span class="keyword">import</span> unicorn</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> pprint <span class="keyword">import</span> pprint</span><br><span class="line"></span><br><span class="line"><span class="comment"># unicorn 版本信息（可选）</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    ver = unicorn.__version__</span><br><span class="line"><span class="keyword">except</span> Exception:</span><br><span class="line">    ver = <span class="string">&quot;&lt;unknown&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 收集 UC_X86_REG_* 常量</span></span><br><span class="line">consts = &#123;name: <span class="built_in">getattr</span>(xc, name) <span class="keyword">for</span> name <span class="keyword">in</span> <span class="built_in">dir</span>(xc) <span class="keyword">if</span> name.startswith(<span class="string">&quot;UC_X86_REG_&quot;</span>)&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 反查表： value -&gt; name (若有冲突，保留列表)</span></span><br><span class="line">inv = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> name, val <span class="keyword">in</span> consts.items():</span><br><span class="line">    inv.setdefault(val, []).append(name)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出信息</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;unicorn version:&quot;</span>, ver)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Total UC_X86_REG_* constants:&quot;</span>, <span class="built_in">len</span>(consts))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n-- 常量按数值排序（value -&gt; name） --\n&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> val <span class="keyword">in</span> <span class="built_in">sorted</span>(inv):</span><br><span class="line">    names = <span class="string">&quot;, &quot;</span>.join(inv[val])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;val:4d&#125;</span> -&gt; <span class="subst">&#123;names&#125;</span>&quot;</span>)(<span class="number">43</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br></pre></td><td class="code"><pre><span class="line">(py39) C:\Users\Lenovo\OneDrive\Desktop\chal&gt;python 2.py</span><br><span class="line">unicorn version: 2.1.4</span><br><span class="line">Total UC_X86_REG_* constants: 240</span><br><span class="line"></span><br><span class="line">-- 常量按数值排序（value -&gt; name） --</span><br><span class="line"></span><br><span class="line">   0 -&gt; UC_X86_REG_INVALID</span><br><span class="line">   1 -&gt; UC_X86_REG_AH</span><br><span class="line">   2 -&gt; UC_X86_REG_AL</span><br><span class="line">   3 -&gt; UC_X86_REG_AX</span><br><span class="line">   4 -&gt; UC_X86_REG_BH</span><br><span class="line">   5 -&gt; UC_X86_REG_BL</span><br><span class="line">   6 -&gt; UC_X86_REG_BP</span><br><span class="line">   7 -&gt; UC_X86_REG_BPL</span><br><span class="line">   8 -&gt; UC_X86_REG_BX</span><br><span class="line">   9 -&gt; UC_X86_REG_CH</span><br><span class="line">  10 -&gt; UC_X86_REG_CL</span><br><span class="line">  11 -&gt; UC_X86_REG_CS</span><br><span class="line">  12 -&gt; UC_X86_REG_CX</span><br><span class="line">  13 -&gt; UC_X86_REG_DH</span><br><span class="line">  14 -&gt; UC_X86_REG_DI</span><br><span class="line">  15 -&gt; UC_X86_REG_DIL</span><br><span class="line">  16 -&gt; UC_X86_REG_DL</span><br><span class="line">  17 -&gt; UC_X86_REG_DS</span><br><span class="line">  18 -&gt; UC_X86_REG_DX</span><br><span class="line">  19 -&gt; UC_X86_REG_EAX</span><br><span class="line">  20 -&gt; UC_X86_REG_EBP</span><br><span class="line">  21 -&gt; UC_X86_REG_EBX</span><br><span class="line">  22 -&gt; UC_X86_REG_ECX</span><br><span class="line">  23 -&gt; UC_X86_REG_EDI</span><br><span class="line">  24 -&gt; UC_X86_REG_EDX</span><br><span class="line">  25 -&gt; UC_X86_REG_EFLAGS</span><br><span class="line">  26 -&gt; UC_X86_REG_EIP</span><br><span class="line">  28 -&gt; UC_X86_REG_ES</span><br><span class="line">  29 -&gt; UC_X86_REG_ESI</span><br><span class="line">  30 -&gt; UC_X86_REG_ESP</span><br><span class="line">  31 -&gt; UC_X86_REG_FPSW</span><br><span class="line">  32 -&gt; UC_X86_REG_FS</span><br><span class="line">  33 -&gt; UC_X86_REG_GS</span><br><span class="line">  34 -&gt; UC_X86_REG_IP</span><br><span class="line">  35 -&gt; UC_X86_REG_RAX</span><br><span class="line">  36 -&gt; UC_X86_REG_RBP</span><br><span class="line">  37 -&gt; UC_X86_REG_RBX</span><br><span class="line">  38 -&gt; UC_X86_REG_RCX</span><br><span class="line">  39 -&gt; UC_X86_REG_RDI</span><br><span class="line">  40 -&gt; UC_X86_REG_RDX</span><br><span class="line">  41 -&gt; UC_X86_REG_RIP</span><br><span class="line">  43 -&gt; UC_X86_REG_RSI</span><br><span class="line">  44 -&gt; UC_X86_REG_RSP</span><br><span class="line">  45 -&gt; UC_X86_REG_SI</span><br><span class="line">  46 -&gt; UC_X86_REG_SIL</span><br><span class="line">  47 -&gt; UC_X86_REG_SP</span><br><span class="line">  48 -&gt; UC_X86_REG_SPL</span><br><span class="line">  49 -&gt; UC_X86_REG_SS</span><br><span class="line">  50 -&gt; UC_X86_REG_CR0</span><br><span class="line">  51 -&gt; UC_X86_REG_CR1</span><br><span class="line">  52 -&gt; UC_X86_REG_CR2</span><br><span class="line">  53 -&gt; UC_X86_REG_CR3</span><br><span class="line">  54 -&gt; UC_X86_REG_CR4</span><br><span class="line">  58 -&gt; UC_X86_REG_CR8</span><br><span class="line">  66 -&gt; UC_X86_REG_DR0</span><br><span class="line">  67 -&gt; UC_X86_REG_DR1</span><br><span class="line">  68 -&gt; UC_X86_REG_DR2</span><br><span class="line">  69 -&gt; UC_X86_REG_DR3</span><br><span class="line">  70 -&gt; UC_X86_REG_DR4</span><br><span class="line">  71 -&gt; UC_X86_REG_DR5</span><br><span class="line">  72 -&gt; UC_X86_REG_DR6</span><br><span class="line">  73 -&gt; UC_X86_REG_DR7</span><br><span class="line">  82 -&gt; UC_X86_REG_FP0</span><br><span class="line">  83 -&gt; UC_X86_REG_FP1</span><br><span class="line">  84 -&gt; UC_X86_REG_FP2</span><br><span class="line">  85 -&gt; UC_X86_REG_FP3</span><br><span class="line">  86 -&gt; UC_X86_REG_FP4</span><br><span class="line">  87 -&gt; UC_X86_REG_FP5</span><br><span class="line">  88 -&gt; UC_X86_REG_FP6</span><br><span class="line">  89 -&gt; UC_X86_REG_FP7</span><br><span class="line">  90 -&gt; UC_X86_REG_K0</span><br><span class="line">  91 -&gt; UC_X86_REG_K1</span><br><span class="line">  92 -&gt; UC_X86_REG_K2</span><br><span class="line">  93 -&gt; UC_X86_REG_K3</span><br><span class="line">  94 -&gt; UC_X86_REG_K4</span><br><span class="line">  95 -&gt; UC_X86_REG_K5</span><br><span class="line">  96 -&gt; UC_X86_REG_K6</span><br><span class="line">  97 -&gt; UC_X86_REG_K7</span><br><span class="line">  98 -&gt; UC_X86_REG_MM0</span><br><span class="line">  99 -&gt; UC_X86_REG_MM1</span><br><span class="line"> 100 -&gt; UC_X86_REG_MM2</span><br><span class="line"> 101 -&gt; UC_X86_REG_MM3</span><br><span class="line"> 102 -&gt; UC_X86_REG_MM4</span><br><span class="line"> 103 -&gt; UC_X86_REG_MM5</span><br><span class="line"> 104 -&gt; UC_X86_REG_MM6</span><br><span class="line"> 105 -&gt; UC_X86_REG_MM7</span><br><span class="line"> 106 -&gt; UC_X86_REG_R8</span><br><span class="line"> 107 -&gt; UC_X86_REG_R9</span><br><span class="line"> 108 -&gt; UC_X86_REG_R10</span><br><span class="line"> 109 -&gt; UC_X86_REG_R11</span><br><span class="line"> 110 -&gt; UC_X86_REG_R12</span><br><span class="line"> 111 -&gt; UC_X86_REG_R13</span><br><span class="line"> 112 -&gt; UC_X86_REG_R14</span><br><span class="line"> 113 -&gt; UC_X86_REG_R15</span><br><span class="line"> 114 -&gt; UC_X86_REG_ST0</span><br><span class="line"> 115 -&gt; UC_X86_REG_ST1</span><br><span class="line"> 116 -&gt; UC_X86_REG_ST2</span><br><span class="line"> 117 -&gt; UC_X86_REG_ST3</span><br><span class="line"> 118 -&gt; UC_X86_REG_ST4</span><br><span class="line"> 119 -&gt; UC_X86_REG_ST5</span><br><span class="line"> 120 -&gt; UC_X86_REG_ST6</span><br><span class="line"> 121 -&gt; UC_X86_REG_ST7</span><br><span class="line"> 122 -&gt; UC_X86_REG_XMM0</span><br><span class="line"> 123 -&gt; UC_X86_REG_XMM1</span><br><span class="line"> 124 -&gt; UC_X86_REG_XMM2</span><br><span class="line"> 125 -&gt; UC_X86_REG_XMM3</span><br><span class="line"> 126 -&gt; UC_X86_REG_XMM4</span><br><span class="line"> 127 -&gt; UC_X86_REG_XMM5</span><br><span class="line"> 128 -&gt; UC_X86_REG_XMM6</span><br><span class="line"> 129 -&gt; UC_X86_REG_XMM7</span><br><span class="line"> 130 -&gt; UC_X86_REG_XMM8</span><br><span class="line"> 131 -&gt; UC_X86_REG_XMM9</span><br><span class="line"> 132 -&gt; UC_X86_REG_XMM10</span><br><span class="line"> 133 -&gt; UC_X86_REG_XMM11</span><br><span class="line"> 134 -&gt; UC_X86_REG_XMM12</span><br><span class="line"> 135 -&gt; UC_X86_REG_XMM13</span><br><span class="line"> 136 -&gt; UC_X86_REG_XMM14</span><br><span class="line"> 137 -&gt; UC_X86_REG_XMM15</span><br><span class="line"> 138 -&gt; UC_X86_REG_XMM16</span><br><span class="line"> 139 -&gt; UC_X86_REG_XMM17</span><br><span class="line"> 140 -&gt; UC_X86_REG_XMM18</span><br><span class="line"> 141 -&gt; UC_X86_REG_XMM19</span><br><span class="line"> 142 -&gt; UC_X86_REG_XMM20</span><br><span class="line"> 143 -&gt; UC_X86_REG_XMM21</span><br><span class="line"> 144 -&gt; UC_X86_REG_XMM22</span><br><span class="line"> 145 -&gt; UC_X86_REG_XMM23</span><br><span class="line"> 146 -&gt; UC_X86_REG_XMM24</span><br><span class="line"> 147 -&gt; UC_X86_REG_XMM25</span><br><span class="line"> 148 -&gt; UC_X86_REG_XMM26</span><br><span class="line"> 149 -&gt; UC_X86_REG_XMM27</span><br><span class="line"> 150 -&gt; UC_X86_REG_XMM28</span><br><span class="line"> 151 -&gt; UC_X86_REG_XMM29</span><br><span class="line"> 152 -&gt; UC_X86_REG_XMM30</span><br><span class="line"> 153 -&gt; UC_X86_REG_XMM31</span><br><span class="line"> 154 -&gt; UC_X86_REG_YMM0</span><br><span class="line"> 155 -&gt; UC_X86_REG_YMM1</span><br><span class="line"> 156 -&gt; UC_X86_REG_YMM2</span><br><span class="line"> 157 -&gt; UC_X86_REG_YMM3</span><br><span class="line"> 158 -&gt; UC_X86_REG_YMM4</span><br><span class="line"> 159 -&gt; UC_X86_REG_YMM5</span><br><span class="line"> 160 -&gt; UC_X86_REG_YMM6</span><br><span class="line"> 161 -&gt; UC_X86_REG_YMM7</span><br><span class="line"> 162 -&gt; UC_X86_REG_YMM8</span><br><span class="line"> 163 -&gt; UC_X86_REG_YMM9</span><br><span class="line"> 164 -&gt; UC_X86_REG_YMM10</span><br><span class="line"> 165 -&gt; UC_X86_REG_YMM11</span><br><span class="line"> 166 -&gt; UC_X86_REG_YMM12</span><br><span class="line"> 167 -&gt; UC_X86_REG_YMM13</span><br><span class="line"> 168 -&gt; UC_X86_REG_YMM14</span><br><span class="line"> 169 -&gt; UC_X86_REG_YMM15</span><br><span class="line"> 170 -&gt; UC_X86_REG_YMM16</span><br><span class="line"> 171 -&gt; UC_X86_REG_YMM17</span><br><span class="line"> 172 -&gt; UC_X86_REG_YMM18</span><br><span class="line"> 173 -&gt; UC_X86_REG_YMM19</span><br><span class="line"> 174 -&gt; UC_X86_REG_YMM20</span><br><span class="line"> 175 -&gt; UC_X86_REG_YMM21</span><br><span class="line"> 176 -&gt; UC_X86_REG_YMM22</span><br><span class="line"> 177 -&gt; UC_X86_REG_YMM23</span><br><span class="line"> 178 -&gt; UC_X86_REG_YMM24</span><br><span class="line"> 179 -&gt; UC_X86_REG_YMM25</span><br><span class="line"> 180 -&gt; UC_X86_REG_YMM26</span><br><span class="line"> 181 -&gt; UC_X86_REG_YMM27</span><br><span class="line"> 182 -&gt; UC_X86_REG_YMM28</span><br><span class="line"> 183 -&gt; UC_X86_REG_YMM29</span><br><span class="line"> 184 -&gt; UC_X86_REG_YMM30</span><br><span class="line"> 185 -&gt; UC_X86_REG_YMM31</span><br><span class="line"> 186 -&gt; UC_X86_REG_ZMM0</span><br><span class="line"> 187 -&gt; UC_X86_REG_ZMM1</span><br><span class="line"> 188 -&gt; UC_X86_REG_ZMM2</span><br><span class="line"> 189 -&gt; UC_X86_REG_ZMM3</span><br><span class="line"> 190 -&gt; UC_X86_REG_ZMM4</span><br><span class="line"> 191 -&gt; UC_X86_REG_ZMM5</span><br><span class="line"> 192 -&gt; UC_X86_REG_ZMM6</span><br><span class="line"> 193 -&gt; UC_X86_REG_ZMM7</span><br><span class="line"> 194 -&gt; UC_X86_REG_ZMM8</span><br><span class="line"> 195 -&gt; UC_X86_REG_ZMM9</span><br><span class="line"> 196 -&gt; UC_X86_REG_ZMM10</span><br><span class="line"> 197 -&gt; UC_X86_REG_ZMM11</span><br><span class="line"> 198 -&gt; UC_X86_REG_ZMM12</span><br><span class="line"> 199 -&gt; UC_X86_REG_ZMM13</span><br><span class="line"> 200 -&gt; UC_X86_REG_ZMM14</span><br><span class="line"> 201 -&gt; UC_X86_REG_ZMM15</span><br><span class="line"> 202 -&gt; UC_X86_REG_ZMM16</span><br><span class="line"> 203 -&gt; UC_X86_REG_ZMM17</span><br><span class="line"> 204 -&gt; UC_X86_REG_ZMM18</span><br><span class="line"> 205 -&gt; UC_X86_REG_ZMM19</span><br><span class="line"> 206 -&gt; UC_X86_REG_ZMM20</span><br><span class="line"> 207 -&gt; UC_X86_REG_ZMM21</span><br><span class="line"> 208 -&gt; UC_X86_REG_ZMM22</span><br><span class="line"> 209 -&gt; UC_X86_REG_ZMM23</span><br><span class="line"> 210 -&gt; UC_X86_REG_ZMM24</span><br><span class="line"> 211 -&gt; UC_X86_REG_ZMM25</span><br><span class="line"> 212 -&gt; UC_X86_REG_ZMM26</span><br><span class="line"> 213 -&gt; UC_X86_REG_ZMM27</span><br><span class="line"> 214 -&gt; UC_X86_REG_ZMM28</span><br><span class="line"> 215 -&gt; UC_X86_REG_ZMM29</span><br><span class="line"> 216 -&gt; UC_X86_REG_ZMM30</span><br><span class="line"> 217 -&gt; UC_X86_REG_ZMM31</span><br><span class="line"> 218 -&gt; UC_X86_REG_R8B</span><br><span class="line"> 219 -&gt; UC_X86_REG_R9B</span><br><span class="line"> 220 -&gt; UC_X86_REG_R10B</span><br><span class="line"> 221 -&gt; UC_X86_REG_R11B</span><br><span class="line"> 222 -&gt; UC_X86_REG_R12B</span><br><span class="line"> 223 -&gt; UC_X86_REG_R13B</span><br><span class="line"> 224 -&gt; UC_X86_REG_R14B</span><br><span class="line"> 225 -&gt; UC_X86_REG_R15B</span><br><span class="line"> 226 -&gt; UC_X86_REG_R8D</span><br><span class="line"> 227 -&gt; UC_X86_REG_R9D</span><br><span class="line"> 228 -&gt; UC_X86_REG_R10D</span><br><span class="line"> 229 -&gt; UC_X86_REG_R11D</span><br><span class="line"> 230 -&gt; UC_X86_REG_R12D</span><br><span class="line"> 231 -&gt; UC_X86_REG_R13D</span><br><span class="line"> 232 -&gt; UC_X86_REG_R14D</span><br><span class="line"> 233 -&gt; UC_X86_REG_R15D</span><br><span class="line"> 234 -&gt; UC_X86_REG_R8W</span><br><span class="line"> 235 -&gt; UC_X86_REG_R9W</span><br><span class="line"> 236 -&gt; UC_X86_REG_R10W</span><br><span class="line"> 237 -&gt; UC_X86_REG_R11W</span><br><span class="line"> 238 -&gt; UC_X86_REG_R12W</span><br><span class="line"> 239 -&gt; UC_X86_REG_R13W</span><br><span class="line"> 240 -&gt; UC_X86_REG_R14W</span><br><span class="line"> 241 -&gt; UC_X86_REG_R15W</span><br><span class="line"> 242 -&gt; UC_X86_REG_IDTR</span><br><span class="line"> 243 -&gt; UC_X86_REG_GDTR</span><br><span class="line"> 244 -&gt; UC_X86_REG_LDTR</span><br><span class="line"> 245 -&gt; UC_X86_REG_TR</span><br><span class="line"> 246 -&gt; UC_X86_REG_FPCW</span><br><span class="line"> 247 -&gt; UC_X86_REG_FPTAG</span><br><span class="line"> 248 -&gt; UC_X86_REG_MSR</span><br><span class="line"> 249 -&gt; UC_X86_REG_MXCSR</span><br><span class="line"> 250 -&gt; UC_X86_REG_FS_BASE</span><br><span class="line"> 251 -&gt; UC_X86_REG_GS_BASE</span><br><span class="line"> 252 -&gt; UC_X86_REG_FLAGS</span><br><span class="line"> 253 -&gt; UC_X86_REG_RFLAGS</span><br><span class="line"> 254 -&gt; UC_X86_REG_FIP</span><br><span class="line"> 255 -&gt; UC_X86_REG_FCS</span><br><span class="line"> 256 -&gt; UC_X86_REG_FDP</span><br><span class="line"> 257 -&gt; UC_X86_REG_FDS</span><br><span class="line"> 258 -&gt; UC_X86_REG_FOP</span><br><span class="line"> 259 -&gt; UC_X86_REG_ENDINGRSI</span><br></pre></td></tr></table></figure>
<p>64 位下：函数参数主要是 通过寄存器传递 的，而不是栈。前 6 个参数分别放在：</p>
<ul>
<li><p>rdi → 第 1 个参数</p>
</li>
<li><p>rsi → 第 2 个参数</p>
</li>
<li><p>rdx → 第 3 个参数</p>
</li>
<li><p>rcx → 第 4 个参数</p>
</li>
<li><p>r8 → 第 5 个参数</p>
</li>
<li><p>r9 → 第 6 个参数</p>
</li>
</ul>
<p>所以a3就是key也就是7</p>
<h2 id="exp："><a href="#exp：" class="headerlink" title="exp："></a>exp：</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">data: <span class="built_in">bytes</span>, key: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    result = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> e <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">40</span> * b + (key ^ b)) &amp; <span class="number">0xFF</span> == e:</span><br><span class="line">                    result.append(b)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    enc = <span class="string">&quot;425MvHMxtLqZ3ty3RZkw3mwwulNRjkswbpkDMK+3CDCOtbe6kzAqPyrcEAI=&quot;</span></span><br><span class="line">    b = base64.b64decode(enc)</span><br><span class="line">    dec = decrypt(b, <span class="number">7</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(dec.decode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line"><span class="keyword">except</span> UnicodeDecodeError <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(e)<span class="keyword">or</span> <span class="keyword">as</span> e:</span><br><span class="line"><span class="built_in">print</span>(e)</span><br></pre></td></tr></table></figure>
<p>flag：DASCTF{un1c0rn_1s_u4fal_And_h0w_ab0ut_exec?}</p>
<h1 id="reference："><a href="#reference：" class="headerlink" title="reference："></a>reference：</h1><p><a target="_blank" rel="noopener" href="https://cn-sec.com/archives/4619296.html">2025 羊城杯网络安全大赛 线上初赛 逆向 PLUS Writeup | CN-SEC 中文网</a></p>



    
    
    
        <div class="reward-container">
  <div>您的支持将鼓励我继续创作!</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/reward.jpg" alt="s0m1ng 微信支付">
        <p>微信支付</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>s0m1ng
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://example.com/2025/10/30/ctf%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84misc/2025%E7%BE%8A%E5%9F%8E%E6%9D%AFPLUS/" title="2025羊城杯PLUS与pyd逆向">http://example.com/2025/10/30/ctf逆向中的misc/2025羊城杯PLUS/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/pyd%E9%80%86%E5%90%91/" rel="tag"><i class="fa fa-tag"></i> pyd逆向</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/10/27/ctf%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84misc/tauri%E6%A1%86%E6%9E%B6%E9%80%86%E5%90%91/" rel="prev" title="tauri框架逆向">
      <i class="fa fa-chevron-left"></i> tauri框架逆向
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80%EF%BC%9A"><span class="nav-number">1.</span> <span class="nav-text">前言：</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%81%9A%E9%A2%98%E6%B5%81%E7%A8%8B%EF%BC%9A"><span class="nav-number">2.</span> <span class="nav-text">做题流程：</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%96%B9%E6%B3%95%EF%BC%9A"><span class="nav-number">2.1.</span> <span class="nav-text">获取方法：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96pyd%E6%96%B9%E6%B3%95%E6%BA%90%E7%A0%81"><span class="nav-number">2.2.</span> <span class="nav-text">获取pyd方法源码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E5%8C%96%EF%BC%9A"><span class="nav-number">2.3.</span> <span class="nav-text">简化：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0"><span class="nav-number">2.4.</span> <span class="nav-text">获取函数参数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#exp%EF%BC%9A"><span class="nav-number">2.5.</span> <span class="nav-text">exp：</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#reference%EF%BC%9A"><span class="nav-number">3.</span> <span class="nav-text">reference：</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="s0m1ng"
      src="/images/profile_photo.jpg">
  <p class="site-author-name" itemprop="name">s0m1ng</p>
  <div class="site-description" itemprop="description">学习逆向贵在坚持</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">18</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="http://wpa.qq.com/msgrd?v=3&uin=1327470638&site=qq&menu=yes" title="QQ → http:&#x2F;&#x2F;wpa.qq.com&#x2F;msgrd?v&#x3D;3&amp;uin&#x3D;1327470638&amp;site&#x3D;qq&amp;menu&#x3D;yes" rel="noopener" target="_blank"><i class="fab fa-qq fa-fw"></i>QQ</a>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">s0m1ng</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script size="300" alpha="0.6" zIndex="-1" src="/lib/canvas-ribbon/canvas-ribbon.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  

</body>
</html>
