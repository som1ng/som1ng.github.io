<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="VnNixUxQwNBvFc-nAdXdfYkKhdk4ncl53flMSHEm1gw">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","width":300,"display":"post","padding":18,"offset":12,"onmobile":true},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.json"};
  </script>

  <meta name="description" content="前言：逆向工程中往往使用aes加密的程序不是用的查表法aes，就是用的白盒aes，让你难以分析，傻乎乎的使用aes基础算法很容易被破解 查表法实现的aes：在前一篇文章中我们详细讲解了AES的每一轮中具体的四层结构，以加密过程为例分别是：字节代换层、行移位层、列混淆层和轮密钥加层 对于查表法实现，就是要将每一轮中的前三层操作(字节代换层、行移位层和列混淆层)合并为查找表。 查表法的核心思想是将字节">
<meta property="og:type" content="article">
<meta property="og:title" content="逆向中的AES(二)">
<meta property="og:url" content="http://example.com/2025/10/09/%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6/aes2/index.html">
<meta property="og:site_name" content="s0m1ng">
<meta property="og:description" content="前言：逆向工程中往往使用aes加密的程序不是用的查表法aes，就是用的白盒aes，让你难以分析，傻乎乎的使用aes基础算法很容易被破解 查表法实现的aes：在前一篇文章中我们详细讲解了AES的每一轮中具体的四层结构，以加密过程为例分别是：字节代换层、行移位层、列混淆层和轮密钥加层 对于查表法实现，就是要将每一轮中的前三层操作(字节代换层、行移位层和列混淆层)合并为查找表。 查表法的核心思想是将字节">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/aes/%E6%9F%A5%E8%A1%A8%E6%B3%95aes.jpg">
<meta property="og:image" content="http://example.com/images/aes/DFA1.png">
<meta property="og:image" content="http://example.com/images/aes/DFA2.png">
<meta property="og:image" content="http://example.com/images/aes/DFA3.png">
<meta property="og:image" content="http://example.com/images/aes/DFA4.png">
<meta property="og:image" content="http://example.com/images/aes/DFA5.png">
<meta property="og:image" content="http://example.com/images/aes/DFA6.png">
<meta property="og:image" content="http://example.com/images/aes/DFA7.png">
<meta property="og:image" content="http://example.com/images/aes/DFA8.png">
<meta property="article:published_time" content="2025-10-08T16:00:00.000Z">
<meta property="article:modified_time" content="2025-10-15T14:07:05.829Z">
<meta property="article:author" content="s0m1ng">
<meta property="article:tag" content="aes">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/aes/%E6%9F%A5%E8%A1%A8%E6%B3%95aes.jpg">

<link rel="canonical" href="http://example.com/2025/10/09/%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6/aes2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>逆向中的AES(二) | s0m1ng</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style><link rel="alternate" href="/atom.xml" title="s0m1ng" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">s0m1ng</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">二进制学习中</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    

  <a href="https://github.com/som1ng" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/10/09/%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6/aes2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/profile_photo.jpg">
      <meta itemprop="name" content="s0m1ng">
      <meta itemprop="description" content="学习逆向贵在坚持">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="s0m1ng">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          逆向中的AES(二)
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-10-09 00:00:00" itemprop="dateCreated datePublished" datetime="2025-10-09T00:00:00+08:00">2025-10-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-15 22:07:05" itemprop="dateModified" datetime="2025-10-15T22:07:05+08:00">2025-10-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">逆向中的密码学</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6/%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E9%A2%98%E5%8D%95/" itemprop="url" rel="index"><span itemprop="name">对称加密题单</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>逆向工程中往往使用aes加密的程序不是用的查表法aes，就是用的白盒aes，让你难以分析，傻乎乎的使用aes基础算法很容易被破解</p>
<h1 id="查表法实现的aes："><a href="#查表法实现的aes：" class="headerlink" title="查表法实现的aes："></a>查表法实现的aes：</h1><p>在前一篇文章中我们详细讲解了AES的每一轮中具体的四层结构，以加密过程为例分别是：字节代换层、行移位层、列混淆层和轮密钥加层</p>
<p>对于查表法实现，就是要将每一轮中的前三层操作(字节代换层、行移位层和列混淆层)合并为查找表。</p>
<p>查表法的核心思想是将字节代换层、ShiftRows层和MixColumn层融合为查找表：每个表的大小是32 bits(4字节)乘以256项，一般称为T盒(T-Box)或T表。加密过程4个表(Te)，解密过程4个表(Td)，共8个。每一轮操作都通过16次查表产生。</p>
<p>算法中定义T表实现为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">T0[x] = (2·S[x])&lt;&lt;<span class="string">24 | (S[x])&lt;&lt;16 | (S[x])&lt;&lt;8 | (3·S[x])</span></span><br><span class="line"><span class="string">T1[x] = (3·S[x])&lt;&lt;24</span> | (2·S[x])&lt;&lt;<span class="string">16 | (S[x])&lt;&lt;8 | (S[x])</span></span><br><span class="line"><span class="string">T2[x] = (S[x])&lt;&lt;24 | (3·S[x])&lt;&lt;16</span> | (2·S[x])&lt;&lt;<span class="string">8 | (S[x])</span></span><br><span class="line"><span class="string">T3[x] = (S[x])&lt;&lt;24 | (S[x])&lt;&lt;16 | (3·S[x])&lt;&lt;8</span> | (2·S[x])</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>其中：</p>
<ul>
<li><p><code>S[x]</code> 是 S-box 输出；</p>
</li>
<li><p><code>2·S[x]</code> 表示有限域 GF(2^8) 下的乘法（即 xtime 运算）。</p>
</li>
</ul>
<h2 id="原理："><a href="#原理：" class="headerlink" title="原理："></a>原理：</h2><p>由于aes加密流程中的字节代换和行移位可随意更改顺序而不影响加密结果，所以，我们把行移位放在最前面</p>
<p><img data-src="/images/aes/查表法aes.jpg" alt="查表法aes"></p>
<p>先不管行移位，把行移位之后的矩阵状态设为</p>
<script type="math/tex; mode=display">
\begin{bmatrix}
a_0 & a_4 & a_8 & a_{12} \\
a_1 & a_5 & a_9 & a_{13} \\
a_2 & a_6 & a_{10} & a_{14} \\
a_3 & a_7 & a_{11} & a_{15}
\end{bmatrix}</script><p>只看第一列的变化，设</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a0<span class="string">' = S[a0]</span></span><br><span class="line"><span class="string">a1'</span> = S[a1]</span><br><span class="line">a2<span class="string">' = S[a2]</span></span><br><span class="line"><span class="string">a3'</span> = S[a3]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<script type="math/tex; mode=display">
\begin{bmatrix}
c_0 \\ c_1 \\ c_2 \\ c_3
\end{bmatrix}
=
\begin{bmatrix}
2 & 3 & 1 & 1 \\
1 & 2 & 3 & 1 \\
1 & 1 & 2 & 3 \\
3 & 1 & 1 & 2
\end{bmatrix}
\begin{bmatrix}
a_0' \\ a_1' \\ a_2' \\ a_3'
\end{bmatrix}</script><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">c0</span> = <span class="number">2</span>·a0<span class="string">' ⊕ 3·a1'</span> ⊕ <span class="number">1</span>·a2<span class="string">' ⊕ 1·a3'</span></span><br><span class="line"><span class="attr">c1</span> = <span class="number">1</span>·a0<span class="string">' ⊕ 2·a1'</span> ⊕ <span class="number">3</span>·a2<span class="string">' ⊕ 1·a3'</span></span><br><span class="line"><span class="attr">c2</span> = <span class="number">1</span>·a0<span class="string">' ⊕ 1·a1'</span> ⊕ <span class="number">2</span>·a2<span class="string">' ⊕ 3·a3'</span></span><br><span class="line"><span class="attr">c3</span> = <span class="number">3</span>·a0<span class="string">' ⊕ 1·a1'</span> ⊕ <span class="number">1</span>·a2<span class="string">' ⊕ 2·a3'</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">T0<span class="section">[x]</span> = (2·S<span class="section">[x]</span>, S<span class="section">[x]</span>, S<span class="section">[x]</span>, 3·S<span class="section">[x]</span>)   // 合并为一个 32 位值</span><br><span class="line">T1<span class="section">[x]</span> = (3·S<span class="section">[x]</span>, 2·S<span class="section">[x]</span>, S<span class="section">[x]</span>, S<span class="section">[x]</span>)</span><br><span class="line">T2<span class="section">[x]</span> = (S<span class="section">[x]</span>, 3·S<span class="section">[x]</span>, 2·S<span class="section">[x]</span>, S<span class="section">[x]</span>)</span><br><span class="line">T3<span class="section">[x]</span> = (S<span class="section">[x]</span>, S<span class="section">[x]</span>, 3·S<span class="section">[x]</span>, 2·S<span class="section">[x]</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>所以</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">T0<span class="section">[a0]</span> = <span class="section">[2·S[a0]</span>, S<span class="section">[a0]</span>, S<span class="section">[a0]</span>, 3·S<span class="section">[a0]]</span></span><br><span class="line">T1<span class="section">[a1]</span> = <span class="section">[3·S[a1]</span>, 2·S<span class="section">[a1]</span>, S<span class="section">[a1]</span>, S<span class="section">[a1]]</span></span><br><span class="line">T2<span class="section">[a2]</span> = <span class="section">[S[a2]</span>, 3·S<span class="section">[a2]</span>, 2·S<span class="section">[a2]</span>, S<span class="section">[a2]]</span></span><br><span class="line">T3<span class="section">[a3]</span> = <span class="section">[S[a3]</span>, S<span class="section">[a3]</span>, 3·S<span class="section">[a3]</span>, 2·S<span class="section">[a3]]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>于是</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">c0c1c2c3</span> = T0[a0] ⊕ T1[a1] ⊕ T2[a2] ⊕ T3[a3]</span><br></pre></td></tr></table></figure>
<p>现在再来考虑行移位的影响，只要把a1-a15的对应标号改掉就行</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">t0</span> = T0[a0] ^ T1[a5] ^ T2[a10] ^ T3[a15] ^ roundKey[<span class="number">0</span>]<span class="comment">;</span></span><br><span class="line"><span class="attr">t1</span> = T0[a4] ^ T1[a9] ^ T2[a14] ^ T3[a3]  ^ roundKey[<span class="number">1</span>]<span class="comment">;</span></span><br><span class="line"><span class="attr">t2</span> = T0[a8] ^ T1[a13]^ T2[a2]  ^ T3[a7]  ^ roundKey[<span class="number">2</span>]<span class="comment">;</span></span><br><span class="line"><span class="attr">t3</span> = T0[a12]^ T1[a1] ^ T2[a6]  ^ T3[a11] ^ roundKey[<span class="number">3</span>]<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="1.556ex" height="1.773ex" role="img" focusable="false" viewBox="0 -626 688 783.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(394,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>是最后加密的结果</p>
<h2 id="代码实现："><a href="#代码实现：" class="headerlink" title="代码实现："></a>代码实现：</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> AES_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> AES_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">AES_Key</span> {</span><br><span class="line">    <span class="type">uint32_t</span>* ek;  <span class="comment">// AES加密轮密钥</span></span><br><span class="line">    <span class="type">uint32_t</span>* dk;  <span class="comment">// AES 解密轮密钥</span></span><br><span class="line">    <span class="type">uint32_t</span> nr;   <span class="comment">//加密轮数</span></span><br><span class="line">} AES_Key;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">AES_KeyInit</span><span class="params">(<span class="type">uint8_t</span>* key, AES_Key* aes_key, <span class="type">size_t</span> bits)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AES_Encrypt</span><span class="params">(<span class="type">uint8_t</span>* plaintext, <span class="type">uint8_t</span>* ciphertext, AES_Key aes_key)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AES_Decrypt</span><span class="params">(<span class="type">uint8_t</span>* ciphertext, <span class="type">uint8_t</span>* plaintext, AES_Key aes_key)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AES_KeyDelete</span><span class="params">(AES_Key aes_key)</span></span>;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint8_t</span> Sbox[<span class="number">256</span>] = {</span><br><span class="line">    <span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2B</span>,</span><br><span class="line">    <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>, <span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>,</span><br><span class="line">    <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>, <span class="number">0x72</span>, <span class="number">0xC0</span>, <span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>,</span><br><span class="line">    <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">    <span class="number">0x04</span>, <span class="number">0xC7</span>, <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>,</span><br><span class="line">    <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>, <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>, <span class="number">0x5A</span>, <span class="number">0xA0</span>,</span><br><span class="line">    <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>, <span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>,</span><br><span class="line">    <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>, <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>,</span><br><span class="line">    <span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>,</span><br><span class="line">    <span class="number">0x50</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0xA8</span>, <span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>,</span><br><span class="line">    <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>, <span class="number">0xCD</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0xEC</span>,</span><br><span class="line">    <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>, <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>,</span><br><span class="line">    <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>, <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>,</span><br><span class="line">    <span class="number">0xC2</span>, <span class="number">0xD3</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>, <span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>,</span><br><span class="line">    <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0xAE</span>, <span class="number">0x08</span>,</span><br><span class="line">    <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>, <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>,</span><br><span class="line">    <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>, <span class="number">0x70</span>, <span class="number">0x3E</span>, <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>,</span><br><span class="line">    <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>, <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>, <span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>,</span><br><span class="line">    <span class="number">0x69</span>, <span class="number">0xD9</span>, <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>,</span><br><span class="line">    <span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>,</span><br><span class="line">    <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span> };</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> SboxIV[<span class="number">256</span>] = {</span><br><span class="line">  <span class="number">0x52</span>,<span class="number">0x09</span>,<span class="number">0x6A</span>,<span class="number">0xD5</span>,<span class="number">0x30</span>,<span class="number">0x36</span>,<span class="number">0xA5</span>,<span class="number">0x38</span>,<span class="number">0xBF</span>,<span class="number">0x40</span>,<span class="number">0xA3</span>,<span class="number">0x9E</span>,<span class="number">0x81</span>,<span class="number">0xF3</span>,<span class="number">0xD7</span>,<span class="number">0xFB</span>,</span><br><span class="line">  <span class="number">0x7C</span>,<span class="number">0xE3</span>,<span class="number">0x39</span>,<span class="number">0x82</span>,<span class="number">0x9B</span>,<span class="number">0x2F</span>,<span class="number">0xFF</span>,<span class="number">0x87</span>,<span class="number">0x34</span>,<span class="number">0x8E</span>,<span class="number">0x43</span>,<span class="number">0x44</span>,<span class="number">0xC4</span>,<span class="number">0xDE</span>,<span class="number">0xE9</span>,<span class="number">0xCB</span>,</span><br><span class="line">  <span class="number">0x54</span>,<span class="number">0x7B</span>,<span class="number">0x94</span>,<span class="number">0x32</span>,<span class="number">0xA6</span>,<span class="number">0xC2</span>,<span class="number">0x23</span>,<span class="number">0x3D</span>,<span class="number">0xEE</span>,<span class="number">0x4C</span>,<span class="number">0x95</span>,<span class="number">0x0B</span>,<span class="number">0x42</span>,<span class="number">0xFA</span>,<span class="number">0xC3</span>,<span class="number">0x4E</span>,</span><br><span class="line">  <span class="number">0x08</span>,<span class="number">0x2E</span>,<span class="number">0xA1</span>,<span class="number">0x66</span>,<span class="number">0x28</span>,<span class="number">0xD9</span>,<span class="number">0x24</span>,<span class="number">0xB2</span>,<span class="number">0x76</span>,<span class="number">0x5B</span>,<span class="number">0xA2</span>,<span class="number">0x49</span>,<span class="number">0x6D</span>,<span class="number">0x8B</span>,<span class="number">0xD1</span>,<span class="number">0x25</span>,</span><br><span class="line">  <span class="number">0x72</span>,<span class="number">0xF8</span>,<span class="number">0xF6</span>,<span class="number">0x64</span>,<span class="number">0x86</span>,<span class="number">0x68</span>,<span class="number">0x98</span>,<span class="number">0x16</span>,<span class="number">0xD4</span>,<span class="number">0xA4</span>,<span class="number">0x5C</span>,<span class="number">0xCC</span>,<span class="number">0x5D</span>,<span class="number">0x65</span>,<span class="number">0xB6</span>,<span class="number">0x92</span>,</span><br><span class="line">  <span class="number">0x6C</span>,<span class="number">0x70</span>,<span class="number">0x48</span>,<span class="number">0x50</span>,<span class="number">0xFD</span>,<span class="number">0xED</span>,<span class="number">0xB9</span>,<span class="number">0xDA</span>,<span class="number">0x5E</span>,<span class="number">0x15</span>,<span class="number">0x46</span>,<span class="number">0x57</span>,<span class="number">0xA7</span>,<span class="number">0x8D</span>,<span class="number">0x9D</span>,<span class="number">0x84</span>,</span><br><span class="line">  <span class="number">0x90</span>,<span class="number">0xD8</span>,<span class="number">0xAB</span>,<span class="number">0x00</span>,<span class="number">0x8C</span>,<span class="number">0xBC</span>,<span class="number">0xD3</span>,<span class="number">0x0A</span>,<span class="number">0xF7</span>,<span class="number">0xE4</span>,<span class="number">0x58</span>,<span class="number">0x05</span>,<span class="number">0xB8</span>,<span class="number">0xB3</span>,<span class="number">0x45</span>,<span class="number">0x06</span>,</span><br><span class="line">  <span class="number">0xD0</span>,<span class="number">0x2C</span>,<span class="number">0x1E</span>,<span class="number">0x8F</span>,<span class="number">0xCA</span>,<span class="number">0x3F</span>,<span class="number">0x0F</span>,<span class="number">0x02</span>,<span class="number">0xC1</span>,<span class="number">0xAF</span>,<span class="number">0xBD</span>,<span class="number">0x03</span>,<span class="number">0x01</span>,<span class="number">0x13</span>,<span class="number">0x8A</span>,<span class="number">0x6B</span>,</span><br><span class="line">  <span class="number">0x3A</span>,<span class="number">0x91</span>,<span class="number">0x11</span>,<span class="number">0x41</span>,<span class="number">0x4F</span>,<span class="number">0x67</span>,<span class="number">0xDC</span>,<span class="number">0xEA</span>,<span class="number">0x97</span>,<span class="number">0xF2</span>,<span class="number">0xCF</span>,<span class="number">0xCE</span>,<span class="number">0xF0</span>,<span class="number">0xB4</span>,<span class="number">0xE6</span>,<span class="number">0x73</span>,</span><br><span class="line">  <span class="number">0x96</span>,<span class="number">0xAC</span>,<span class="number">0x74</span>,<span class="number">0x22</span>,<span class="number">0xE7</span>,<span class="number">0xAD</span>,<span class="number">0x35</span>,<span class="number">0x85</span>,<span class="number">0xE2</span>,<span class="number">0xF9</span>,<span class="number">0x37</span>,<span class="number">0xE8</span>,<span class="number">0x1C</span>,<span class="number">0x75</span>,<span class="number">0xDF</span>,<span class="number">0x6E</span>,</span><br><span class="line">  <span class="number">0x47</span>,<span class="number">0xF1</span>,<span class="number">0x1A</span>,<span class="number">0x71</span>,<span class="number">0x1D</span>,<span class="number">0x29</span>,<span class="number">0xC5</span>,<span class="number">0x89</span>,<span class="number">0x6F</span>,<span class="number">0xB7</span>,<span class="number">0x62</span>,<span class="number">0x0E</span>,<span class="number">0xAA</span>,<span class="number">0x18</span>,<span class="number">0xBE</span>,<span class="number">0x1B</span>,</span><br><span class="line">  <span class="number">0xFC</span>,<span class="number">0x56</span>,<span class="number">0x3E</span>,<span class="number">0x4B</span>,<span class="number">0xC6</span>,<span class="number">0xD2</span>,<span class="number">0x79</span>,<span class="number">0x20</span>,<span class="number">0x9A</span>,<span class="number">0xDB</span>,<span class="number">0xC0</span>,<span class="number">0xFE</span>,<span class="number">0x78</span>,<span class="number">0xCD</span>,<span class="number">0x5A</span>,<span class="number">0xF4</span>,</span><br><span class="line">  <span class="number">0x1F</span>,<span class="number">0xDD</span>,<span class="number">0xA8</span>,<span class="number">0x33</span>,<span class="number">0x88</span>,<span class="number">0x07</span>,<span class="number">0xC7</span>,<span class="number">0x31</span>,<span class="number">0xB1</span>,<span class="number">0x12</span>,<span class="number">0x10</span>,<span class="number">0x59</span>,<span class="number">0x27</span>,<span class="number">0x80</span>,<span class="number">0xEC</span>,<span class="number">0x5F</span>,</span><br><span class="line">  <span class="number">0x60</span>,<span class="number">0x51</span>,<span class="number">0x7F</span>,<span class="number">0xA9</span>,<span class="number">0x19</span>,<span class="number">0xB5</span>,<span class="number">0x4A</span>,<span class="number">0x0D</span>,<span class="number">0x2D</span>,<span class="number">0xE5</span>,<span class="number">0x7A</span>,<span class="number">0x9F</span>,<span class="number">0x93</span>,<span class="number">0xC9</span>,<span class="number">0x9C</span>,<span class="number">0xEF</span>,</span><br><span class="line">  <span class="number">0xA0</span>,<span class="number">0xE0</span>,<span class="number">0x3B</span>,<span class="number">0x4D</span>,<span class="number">0xAE</span>,<span class="number">0x2A</span>,<span class="number">0xF5</span>,<span class="number">0xB0</span>,<span class="number">0xC8</span>,<span class="number">0xEB</span>,<span class="number">0xBB</span>,<span class="number">0x3C</span>,<span class="number">0x83</span>,<span class="number">0x53</span>,<span class="number">0x99</span>,<span class="number">0x61</span>,</span><br><span class="line">  <span class="number">0x17</span>,<span class="number">0x2B</span>,<span class="number">0x04</span>,<span class="number">0x7E</span>,<span class="number">0xBA</span>,<span class="number">0x77</span>,<span class="number">0xD6</span>,<span class="number">0x26</span>,<span class="number">0xE1</span>,<span class="number">0x69</span>,<span class="number">0x14</span>,<span class="number">0x63</span>,<span class="number">0x55</span>,<span class="number">0x21</span>,<span class="number">0x0C</span>,<span class="number">0x7D</span></span><br><span class="line">};</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint32_t</span> TE[<span class="number">256</span>] = {</span><br><span class="line">    <span class="number">0xc66363a5</span>, <span class="number">0xf87c7c84</span>, <span class="number">0xee777799</span>, <span class="number">0xf67b7b8d</span>, <span class="number">0xfff2f20d</span>, <span class="number">0xd66b6bbd</span>,</span><br><span class="line">    <span class="number">0xde6f6fb1</span>, <span class="number">0x91c5c554</span>, <span class="number">0x60303050</span>, <span class="number">0x02010103</span>, <span class="number">0xce6767a9</span>, <span class="number">0x562b2b7d</span>,</span><br><span class="line">    <span class="number">0xe7fefe19</span>, <span class="number">0xb5d7d762</span>, <span class="number">0x4dababe6</span>, <span class="number">0xec76769a</span>, <span class="number">0x8fcaca45</span>, <span class="number">0x1f82829d</span>,</span><br><span class="line">    <span class="number">0x89c9c940</span>, <span class="number">0xfa7d7d87</span>, <span class="number">0xeffafa15</span>, <span class="number">0xb25959eb</span>, <span class="number">0x8e4747c9</span>, <span class="number">0xfbf0f00b</span>,</span><br><span class="line">    <span class="number">0x41adadec</span>, <span class="number">0xb3d4d467</span>, <span class="number">0x5fa2a2fd</span>, <span class="number">0x45afafea</span>, <span class="number">0x239c9cbf</span>, <span class="number">0x53a4a4f7</span>,</span><br><span class="line">    <span class="number">0xe4727296</span>, <span class="number">0x9bc0c05b</span>, <span class="number">0x75b7b7c2</span>, <span class="number">0xe1fdfd1c</span>, <span class="number">0x3d9393ae</span>, <span class="number">0x4c26266a</span>,</span><br><span class="line">    <span class="number">0x6c36365a</span>, <span class="number">0x7e3f3f41</span>, <span class="number">0xf5f7f702</span>, <span class="number">0x83cccc4f</span>, <span class="number">0x6834345c</span>, <span class="number">0x51a5a5f4</span>,</span><br><span class="line">    <span class="number">0xd1e5e534</span>, <span class="number">0xf9f1f108</span>, <span class="number">0xe2717193</span>, <span class="number">0xabd8d873</span>, <span class="number">0x62313153</span>, <span class="number">0x2a15153f</span>,</span><br><span class="line">    <span class="number">0x0804040c</span>, <span class="number">0x95c7c752</span>, <span class="number">0x46232365</span>, <span class="number">0x9dc3c35e</span>, <span class="number">0x30181828</span>, <span class="number">0x379696a1</span>,</span><br><span class="line">    <span class="number">0x0a05050f</span>, <span class="number">0x2f9a9ab5</span>, <span class="number">0x0e070709</span>, <span class="number">0x24121236</span>, <span class="number">0x1b80809b</span>, <span class="number">0xdfe2e23d</span>,</span><br><span class="line">    <span class="number">0xcdebeb26</span>, <span class="number">0x4e272769</span>, <span class="number">0x7fb2b2cd</span>, <span class="number">0xea75759f</span>, <span class="number">0x1209091b</span>, <span class="number">0x1d83839e</span>,</span><br><span class="line">    <span class="number">0x582c2c74</span>, <span class="number">0x341a1a2e</span>, <span class="number">0x361b1b2d</span>, <span class="number">0xdc6e6eb2</span>, <span class="number">0xb45a5aee</span>, <span class="number">0x5ba0a0fb</span>,</span><br><span class="line">    <span class="number">0xa45252f6</span>, <span class="number">0x763b3b4d</span>, <span class="number">0xb7d6d661</span>, <span class="number">0x7db3b3ce</span>, <span class="number">0x5229297b</span>, <span class="number">0xdde3e33e</span>,</span><br><span class="line">    <span class="number">0x5e2f2f71</span>, <span class="number">0x13848497</span>, <span class="number">0xa65353f5</span>, <span class="number">0xb9d1d168</span>, <span class="number">0x00000000</span>, <span class="number">0xc1eded2c</span>,</span><br><span class="line">    <span class="number">0x40202060</span>, <span class="number">0xe3fcfc1f</span>, <span class="number">0x79b1b1c8</span>, <span class="number">0xb65b5bed</span>, <span class="number">0xd46a6abe</span>, <span class="number">0x8dcbcb46</span>,</span><br><span class="line">    <span class="number">0x67bebed9</span>, <span class="number">0x7239394b</span>, <span class="number">0x944a4ade</span>, <span class="number">0x984c4cd4</span>, <span class="number">0xb05858e8</span>, <span class="number">0x85cfcf4a</span>,</span><br><span class="line">    <span class="number">0xbbd0d06b</span>, <span class="number">0xc5efef2a</span>, <span class="number">0x4faaaae5</span>, <span class="number">0xedfbfb16</span>, <span class="number">0x864343c5</span>, <span class="number">0x9a4d4dd7</span>,</span><br><span class="line">    <span class="number">0x66333355</span>, <span class="number">0x11858594</span>, <span class="number">0x8a4545cf</span>, <span class="number">0xe9f9f910</span>, <span class="number">0x04020206</span>, <span class="number">0xfe7f7f81</span>,</span><br><span class="line">    <span class="number">0xa05050f0</span>, <span class="number">0x783c3c44</span>, <span class="number">0x259f9fba</span>, <span class="number">0x4ba8a8e3</span>, <span class="number">0xa25151f3</span>, <span class="number">0x5da3a3fe</span>,</span><br><span class="line">    <span class="number">0x804040c0</span>, <span class="number">0x058f8f8a</span>, <span class="number">0x3f9292ad</span>, <span class="number">0x219d9dbc</span>, <span class="number">0x70383848</span>, <span class="number">0xf1f5f504</span>,</span><br><span class="line">    <span class="number">0x63bcbcdf</span>, <span class="number">0x77b6b6c1</span>, <span class="number">0xafdada75</span>, <span class="number">0x42212163</span>, <span class="number">0x20101030</span>, <span class="number">0xe5ffff1a</span>,</span><br><span class="line">    <span class="number">0xfdf3f30e</span>, <span class="number">0xbfd2d26d</span>, <span class="number">0x81cdcd4c</span>, <span class="number">0x180c0c14</span>, <span class="number">0x26131335</span>, <span class="number">0xc3ecec2f</span>,</span><br><span class="line">    <span class="number">0xbe5f5fe1</span>, <span class="number">0x359797a2</span>, <span class="number">0x884444cc</span>, <span class="number">0x2e171739</span>, <span class="number">0x93c4c457</span>, <span class="number">0x55a7a7f2</span>,</span><br><span class="line">    <span class="number">0xfc7e7e82</span>, <span class="number">0x7a3d3d47</span>, <span class="number">0xc86464ac</span>, <span class="number">0xba5d5de7</span>, <span class="number">0x3219192b</span>, <span class="number">0xe6737395</span>,</span><br><span class="line">    <span class="number">0xc06060a0</span>, <span class="number">0x19818198</span>, <span class="number">0x9e4f4fd1</span>, <span class="number">0xa3dcdc7f</span>, <span class="number">0x44222266</span>, <span class="number">0x542a2a7e</span>,</span><br><span class="line">    <span class="number">0x3b9090ab</span>, <span class="number">0x0b888883</span>, <span class="number">0x8c4646ca</span>, <span class="number">0xc7eeee29</span>, <span class="number">0x6bb8b8d3</span>, <span class="number">0x2814143c</span>,</span><br><span class="line">    <span class="number">0xa7dede79</span>, <span class="number">0xbc5e5ee2</span>, <span class="number">0x160b0b1d</span>, <span class="number">0xaddbdb76</span>, <span class="number">0xdbe0e03b</span>, <span class="number">0x64323256</span>,</span><br><span class="line">    <span class="number">0x743a3a4e</span>, <span class="number">0x140a0a1e</span>, <span class="number">0x924949db</span>, <span class="number">0x0c06060a</span>, <span class="number">0x4824246c</span>, <span class="number">0xb85c5ce4</span>,</span><br><span class="line">    <span class="number">0x9fc2c25d</span>, <span class="number">0xbdd3d36e</span>, <span class="number">0x43acacef</span>, <span class="number">0xc46262a6</span>, <span class="number">0x399191a8</span>, <span class="number">0x319595a4</span>,</span><br><span class="line">    <span class="number">0xd3e4e437</span>, <span class="number">0xf279798b</span>, <span class="number">0xd5e7e732</span>, <span class="number">0x8bc8c843</span>, <span class="number">0x6e373759</span>, <span class="number">0xda6d6db7</span>,</span><br><span class="line">    <span class="number">0x018d8d8c</span>, <span class="number">0xb1d5d564</span>, <span class="number">0x9c4e4ed2</span>, <span class="number">0x49a9a9e0</span>, <span class="number">0xd86c6cb4</span>, <span class="number">0xac5656fa</span>,</span><br><span class="line">    <span class="number">0xf3f4f407</span>, <span class="number">0xcfeaea25</span>, <span class="number">0xca6565af</span>, <span class="number">0xf47a7a8e</span>, <span class="number">0x47aeaee9</span>, <span class="number">0x10080818</span>,</span><br><span class="line">    <span class="number">0x6fbabad5</span>, <span class="number">0xf0787888</span>, <span class="number">0x4a25256f</span>, <span class="number">0x5c2e2e72</span>, <span class="number">0x381c1c24</span>, <span class="number">0x57a6a6f1</span>,</span><br><span class="line">    <span class="number">0x73b4b4c7</span>, <span class="number">0x97c6c651</span>, <span class="number">0xcbe8e823</span>, <span class="number">0xa1dddd7c</span>, <span class="number">0xe874749c</span>, <span class="number">0x3e1f1f21</span>,</span><br><span class="line">    <span class="number">0x964b4bdd</span>, <span class="number">0x61bdbddc</span>, <span class="number">0x0d8b8b86</span>, <span class="number">0x0f8a8a85</span>, <span class="number">0xe0707090</span>, <span class="number">0x7c3e3e42</span>,</span><br><span class="line">    <span class="number">0x71b5b5c4</span>, <span class="number">0xcc6666aa</span>, <span class="number">0x904848d8</span>, <span class="number">0x06030305</span>, <span class="number">0xf7f6f601</span>, <span class="number">0x1c0e0e12</span>,</span><br><span class="line">    <span class="number">0xc26161a3</span>, <span class="number">0x6a35355f</span>, <span class="number">0xae5757f9</span>, <span class="number">0x69b9b9d0</span>, <span class="number">0x17868691</span>, <span class="number">0x99c1c158</span>,</span><br><span class="line">    <span class="number">0x3a1d1d27</span>, <span class="number">0x279e9eb9</span>, <span class="number">0xd9e1e138</span>, <span class="number">0xebf8f813</span>, <span class="number">0x2b9898b3</span>, <span class="number">0x22111133</span>,</span><br><span class="line">    <span class="number">0xd26969bb</span>, <span class="number">0xa9d9d970</span>, <span class="number">0x078e8e89</span>, <span class="number">0x339494a7</span>, <span class="number">0x2d9b9bb6</span>, <span class="number">0x3c1e1e22</span>,</span><br><span class="line">    <span class="number">0x15878792</span>, <span class="number">0xc9e9e920</span>, <span class="number">0x87cece49</span>, <span class="number">0xaa5555ff</span>, <span class="number">0x50282878</span>, <span class="number">0xa5dfdf7a</span>,</span><br><span class="line">    <span class="number">0x038c8c8f</span>, <span class="number">0x59a1a1f8</span>, <span class="number">0x09898980</span>, <span class="number">0x1a0d0d17</span>, <span class="number">0x65bfbfda</span>, <span class="number">0xd7e6e631</span>,</span><br><span class="line">    <span class="number">0x844242c6</span>, <span class="number">0xd06868b8</span>, <span class="number">0x824141c3</span>, <span class="number">0x299999b0</span>, <span class="number">0x5a2d2d77</span>, <span class="number">0x1e0f0f11</span>,</span><br><span class="line">    <span class="number">0x7bb0b0cb</span>, <span class="number">0xa85454fc</span>, <span class="number">0x6dbbbbd6</span>, <span class="number">0x2c16163a</span> };</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint32_t</span> TD[<span class="number">256</span>] = {</span><br><span class="line">    <span class="number">0x51f4a750</span>, <span class="number">0x7e416553</span>, <span class="number">0x1a17a4c3</span>, <span class="number">0x3a275e96</span>, <span class="number">0x3bab6bcb</span>, <span class="number">0x1f9d45f1</span>,</span><br><span class="line">    <span class="number">0xacfa58ab</span>, <span class="number">0x4be30393</span>, <span class="number">0x2030fa55</span>, <span class="number">0xad766df6</span>, <span class="number">0x88cc7691</span>, <span class="number">0xf5024c25</span>,</span><br><span class="line">    <span class="number">0x4fe5d7fc</span>, <span class="number">0xc52acbd7</span>, <span class="number">0x26354480</span>, <span class="number">0xb562a38f</span>, <span class="number">0xdeb15a49</span>, <span class="number">0x25ba1b67</span>,</span><br><span class="line">    <span class="number">0x45ea0e98</span>, <span class="number">0x5dfec0e1</span>, <span class="number">0xc32f7502</span>, <span class="number">0x814cf012</span>, <span class="number">0x8d4697a3</span>, <span class="number">0x6bd3f9c6</span>,</span><br><span class="line">    <span class="number">0x038f5fe7</span>, <span class="number">0x15929c95</span>, <span class="number">0xbf6d7aeb</span>, <span class="number">0x955259da</span>, <span class="number">0xd4be832d</span>, <span class="number">0x587421d3</span>,</span><br><span class="line">    <span class="number">0x49e06929</span>, <span class="number">0x8ec9c844</span>, <span class="number">0x75c2896a</span>, <span class="number">0xf48e7978</span>, <span class="number">0x99583e6b</span>, <span class="number">0x27b971dd</span>,</span><br><span class="line">    <span class="number">0xbee14fb6</span>, <span class="number">0xf088ad17</span>, <span class="number">0xc920ac66</span>, <span class="number">0x7dce3ab4</span>, <span class="number">0x63df4a18</span>, <span class="number">0xe51a3182</span>,</span><br><span class="line">    <span class="number">0x97513360</span>, <span class="number">0x62537f45</span>, <span class="number">0xb16477e0</span>, <span class="number">0xbb6bae84</span>, <span class="number">0xfe81a01c</span>, <span class="number">0xf9082b94</span>,</span><br><span class="line">    <span class="number">0x70486858</span>, <span class="number">0x8f45fd19</span>, <span class="number">0x94de6c87</span>, <span class="number">0x527bf8b7</span>, <span class="number">0xab73d323</span>, <span class="number">0x724b02e2</span>,</span><br><span class="line">    <span class="number">0xe31f8f57</span>, <span class="number">0x6655ab2a</span>, <span class="number">0xb2eb2807</span>, <span class="number">0x2fb5c203</span>, <span class="number">0x86c57b9a</span>, <span class="number">0xd33708a5</span>,</span><br><span class="line">    <span class="number">0x302887f2</span>, <span class="number">0x23bfa5b2</span>, <span class="number">0x02036aba</span>, <span class="number">0xed16825c</span>, <span class="number">0x8acf1c2b</span>, <span class="number">0xa779b492</span>,</span><br><span class="line">    <span class="number">0xf307f2f0</span>, <span class="number">0x4e69e2a1</span>, <span class="number">0x65daf4cd</span>, <span class="number">0x0605bed5</span>, <span class="number">0xd134621f</span>, <span class="number">0xc4a6fe8a</span>,</span><br><span class="line">    <span class="number">0x342e539d</span>, <span class="number">0xa2f355a0</span>, <span class="number">0x058ae132</span>, <span class="number">0xa4f6eb75</span>, <span class="number">0x0b83ec39</span>, <span class="number">0x4060efaa</span>,</span><br><span class="line">    <span class="number">0x5e719f06</span>, <span class="number">0xbd6e1051</span>, <span class="number">0x3e218af9</span>, <span class="number">0x96dd063d</span>, <span class="number">0xdd3e05ae</span>, <span class="number">0x4de6bd46</span>,</span><br><span class="line">    <span class="number">0x91548db5</span>, <span class="number">0x71c45d05</span>, <span class="number">0x0406d46f</span>, <span class="number">0x605015ff</span>, <span class="number">0x1998fb24</span>, <span class="number">0xd6bde997</span>,</span><br><span class="line">    <span class="number">0x894043cc</span>, <span class="number">0x67d99e77</span>, <span class="number">0xb0e842bd</span>, <span class="number">0x07898b88</span>, <span class="number">0xe7195b38</span>, <span class="number">0x79c8eedb</span>,</span><br><span class="line">    <span class="number">0xa17c0a47</span>, <span class="number">0x7c420fe9</span>, <span class="number">0xf8841ec9</span>, <span class="number">0x00000000</span>, <span class="number">0x09808683</span>, <span class="number">0x322bed48</span>,</span><br><span class="line">    <span class="number">0x1e1170ac</span>, <span class="number">0x6c5a724e</span>, <span class="number">0xfd0efffb</span>, <span class="number">0x0f853856</span>, <span class="number">0x3daed51e</span>, <span class="number">0x362d3927</span>,</span><br><span class="line">    <span class="number">0x0a0fd964</span>, <span class="number">0x685ca621</span>, <span class="number">0x9b5b54d1</span>, <span class="number">0x24362e3a</span>, <span class="number">0x0c0a67b1</span>, <span class="number">0x9357e70f</span>,</span><br><span class="line">    <span class="number">0xb4ee96d2</span>, <span class="number">0x1b9b919e</span>, <span class="number">0x80c0c54f</span>, <span class="number">0x61dc20a2</span>, <span class="number">0x5a774b69</span>, <span class="number">0x1c121a16</span>,</span><br><span class="line">    <span class="number">0xe293ba0a</span>, <span class="number">0xc0a02ae5</span>, <span class="number">0x3c22e043</span>, <span class="number">0x121b171d</span>, <span class="number">0x0e090d0b</span>, <span class="number">0xf28bc7ad</span>,</span><br><span class="line">    <span class="number">0x2db6a8b9</span>, <span class="number">0x141ea9c8</span>, <span class="number">0x57f11985</span>, <span class="number">0xaf75074c</span>, <span class="number">0xee99ddbb</span>, <span class="number">0xa37f60fd</span>,</span><br><span class="line">    <span class="number">0xf701269f</span>, <span class="number">0x5c72f5bc</span>, <span class="number">0x44663bc5</span>, <span class="number">0x5bfb7e34</span>, <span class="number">0x8b432976</span>, <span class="number">0xcb23c6dc</span>,</span><br><span class="line">    <span class="number">0xb6edfc68</span>, <span class="number">0xb8e4f163</span>, <span class="number">0xd731dcca</span>, <span class="number">0x42638510</span>, <span class="number">0x13972240</span>, <span class="number">0x84c61120</span>,</span><br><span class="line">    <span class="number">0x854a247d</span>, <span class="number">0xd2bb3df8</span>, <span class="number">0xaef93211</span>, <span class="number">0xc729a16d</span>, <span class="number">0x1d9e2f4b</span>, <span class="number">0xdcb230f3</span>,</span><br><span class="line">    <span class="number">0x0d8652ec</span>, <span class="number">0x77c1e3d0</span>, <span class="number">0x2bb3166c</span>, <span class="number">0xa970b999</span>, <span class="number">0x119448fa</span>, <span class="number">0x47e96422</span>,</span><br><span class="line">    <span class="number">0xa8fc8cc4</span>, <span class="number">0xa0f03f1a</span>, <span class="number">0x567d2cd8</span>, <span class="number">0x223390ef</span>, <span class="number">0x87494ec7</span>, <span class="number">0xd938d1c1</span>,</span><br><span class="line">    <span class="number">0x8ccaa2fe</span>, <span class="number">0x98d40b36</span>, <span class="number">0xa6f581cf</span>, <span class="number">0xa57ade28</span>, <span class="number">0xdab78e26</span>, <span class="number">0x3fadbfa4</span>,</span><br><span class="line">    <span class="number">0x2c3a9de4</span>, <span class="number">0x5078920d</span>, <span class="number">0x6a5fcc9b</span>, <span class="number">0x547e4662</span>, <span class="number">0xf68d13c2</span>, <span class="number">0x90d8b8e8</span>,</span><br><span class="line">    <span class="number">0x2e39f75e</span>, <span class="number">0x82c3aff5</span>, <span class="number">0x9f5d80be</span>, <span class="number">0x69d0937c</span>, <span class="number">0x6fd52da9</span>, <span class="number">0xcf2512b3</span>,</span><br><span class="line">    <span class="number">0xc8ac993b</span>, <span class="number">0x10187da7</span>, <span class="number">0xe89c636e</span>, <span class="number">0xdb3bbb7b</span>, <span class="number">0xcd267809</span>, <span class="number">0x6e5918f4</span>,</span><br><span class="line">    <span class="number">0xec9ab701</span>, <span class="number">0x834f9aa8</span>, <span class="number">0xe6956e65</span>, <span class="number">0xaaffe67e</span>, <span class="number">0x21bccf08</span>, <span class="number">0xef15e8e6</span>,</span><br><span class="line">    <span class="number">0xbae79bd9</span>, <span class="number">0x4a6f36ce</span>, <span class="number">0xea9f09d4</span>, <span class="number">0x29b07cd6</span>, <span class="number">0x31a4b2af</span>, <span class="number">0x2a3f2331</span>,</span><br><span class="line">    <span class="number">0xc6a59430</span>, <span class="number">0x35a266c0</span>, <span class="number">0x744ebc37</span>, <span class="number">0xfc82caa6</span>, <span class="number">0xe090d0b0</span>, <span class="number">0x33a7d815</span>,</span><br><span class="line">    <span class="number">0xf104984a</span>, <span class="number">0x41ecdaf7</span>, <span class="number">0x7fcd500e</span>, <span class="number">0x1791f62f</span>, <span class="number">0x764dd68d</span>, <span class="number">0x43efb04d</span>,</span><br><span class="line">    <span class="number">0xccaa4d54</span>, <span class="number">0xe49604df</span>, <span class="number">0x9ed1b5e3</span>, <span class="number">0x4c6a881b</span>, <span class="number">0xc12c1fb8</span>, <span class="number">0x4665517f</span>,</span><br><span class="line">    <span class="number">0x9d5eea04</span>, <span class="number">0x018c355d</span>, <span class="number">0xfa877473</span>, <span class="number">0xfb0b412e</span>, <span class="number">0xb3671d5a</span>, <span class="number">0x92dbd252</span>,</span><br><span class="line">    <span class="number">0xe9105633</span>, <span class="number">0x6dd64713</span>, <span class="number">0x9ad7618c</span>, <span class="number">0x37a10c7a</span>, <span class="number">0x59f8148e</span>, <span class="number">0xeb133c89</span>,</span><br><span class="line">    <span class="number">0xcea927ee</span>, <span class="number">0xb761c935</span>, <span class="number">0xe11ce5ed</span>, <span class="number">0x7a47b13c</span>, <span class="number">0x9cd2df59</span>, <span class="number">0x55f2733f</span>,</span><br><span class="line">    <span class="number">0x1814ce79</span>, <span class="number">0x73c737bf</span>, <span class="number">0x53f7cdea</span>, <span class="number">0x5ffdaa5b</span>, <span class="number">0xdf3d6f14</span>, <span class="number">0x7844db86</span>,</span><br><span class="line">    <span class="number">0xcaaff381</span>, <span class="number">0xb968c43e</span>, <span class="number">0x3824342c</span>, <span class="number">0xc2a3405f</span>, <span class="number">0x161dc372</span>, <span class="number">0xbce2250c</span>,</span><br><span class="line">    <span class="number">0x283c498b</span>, <span class="number">0xff0d9541</span>, <span class="number">0x39a80171</span>, <span class="number">0x080cb3de</span>, <span class="number">0xd8b4e49c</span>, <span class="number">0x6456c190</span>,</span><br><span class="line">    <span class="number">0x7bcb8461</span>, <span class="number">0xd532b670</span>, <span class="number">0x486c5c74</span>, <span class="number">0xd0b85742</span> };</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rotr32(value, shift) ((value &gt;&gt; shift) ^ (value &lt;&lt; (32 - shift)))</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">AES_KeyInit</span><span class="params">(<span class="type">uint8_t</span>* key, AES_Key* aes_key, <span class="type">size_t</span> bits)</span> </span>{</span><br><span class="line">    <span class="type">uint32_t</span> Rcon[<span class="number">10</span>] = { <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>,</span><br><span class="line">                         <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x80</span>, <span class="number">0x1B</span>, <span class="number">0x36</span> };  <span class="comment">//轮常数</span></span><br><span class="line">    <span class="type">uint32_t</span> nr = <span class="number">10</span> + (bits - <span class="number">128</span>) / <span class="number">32</span>;                <span class="comment">//加密轮数 Nr</span></span><br><span class="line">    <span class="type">uint32_t</span> nk = bits / <span class="number">32</span>;                             <span class="comment">//密钥字数 Nk</span></span><br><span class="line">    <span class="type">uint32_t</span> tmp, tmp1;</span><br><span class="line">    aes_key-&gt;nr = nr;</span><br><span class="line">    <span class="comment">//-----------malloc-------------</span></span><br><span class="line">    <span class="type">uint32_t</span>* w = (<span class="type">uint32_t</span>*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(<span class="type">uint32_t</span>) * <span class="number">4</span> * (nr + <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">if</span> (w == (<span class="type">void</span>*)<span class="number">0</span>) {</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="type">uint32_t</span>* d = (<span class="type">uint32_t</span>*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(<span class="type">uint32_t</span>) * <span class="number">4</span> * (nr + <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">if</span> (d == (<span class="type">void</span>*)<span class="number">0</span>) {</span><br><span class="line">        <span class="built_in">free</span>(d);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">//--------------Load as BigEndian---------------</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nk; i++) {<span class="comment">//将总的bits，每32个（四个字节）分一组，每一组用大端序来进行表示</span></span><br><span class="line">        w[i] = (key[<span class="number">4</span> * i + <span class="number">0</span>] &lt;&lt; <span class="number">24</span>) | (key[<span class="number">4</span> * i + <span class="number">1</span>] &lt;&lt; <span class="number">16</span>) |</span><br><span class="line">            (key[<span class="number">4</span> * i + <span class="number">2</span>] &lt;&lt; <span class="number">8</span>) | (key[<span class="number">4</span> * i + <span class="number">3</span>]);</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">//------------KeyExpand-----------------</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = nk; i &lt; <span class="number">4</span> * (nr + <span class="number">1</span>); i++) {</span><br><span class="line">        tmp = w[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> (i % nk == <span class="number">0</span>) {</span><br><span class="line">            <span class="comment">/* tmp = SubWord(RotWord(w[i-1])) */</span></span><br><span class="line">            tmp1 = tmp;</span><br><span class="line">            tmp = Sbox[(tmp1 &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">            tmp |= Sbox[(tmp1 &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">            tmp |= Sbox[(tmp1 &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">16</span>;</span><br><span class="line">            tmp |= (Sbox[(tmp1 &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>] ^ Rcon[i / nk - <span class="number">1</span>]) &lt;&lt; <span class="number">24</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (nk &gt; <span class="number">6</span> &amp;&amp; i % nk == <span class="number">4</span>) {</span><br><span class="line">            <span class="comment">/* temp = SubWord(w[i-1]) */</span></span><br><span class="line">            tmp1 = tmp;</span><br><span class="line">            tmp = Sbox[(tmp1 &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">            tmp |= Sbox[(tmp1 &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">            tmp |= Sbox[(tmp1 &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">16</span>;</span><br><span class="line">            tmp |= Sbox[(tmp1 &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">24</span>;</span><br><span class="line">        }</span><br><span class="line">        w[i] = w[i - nk] ^ tmp;</span><br><span class="line">    }</span><br><span class="line">    aes_key-&gt;ek = w;</span><br><span class="line">    <span class="comment">//------------TransKey-----------</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) {</span><br><span class="line">        d[i] = w[i];</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">4</span>; i &lt; <span class="number">4</span> * nr; i++) {</span><br><span class="line">        <span class="comment">//-----------MixCol IV-----------</span></span><br><span class="line">        d[i] = TD[Sbox[(w[i] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>]];</span><br><span class="line">        tmp = TD[Sbox[(w[i] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>]];</span><br><span class="line">        d[i] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">8</span>);</span><br><span class="line">        tmp = TD[Sbox[(w[i] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>]];</span><br><span class="line">        d[i] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">16</span>);</span><br><span class="line">        tmp = TD[Sbox[(w[i] &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>]];</span><br><span class="line">        d[i] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">24</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) {</span><br><span class="line">        d[<span class="number">4</span> * nr + i] = w[<span class="number">4</span> * nr + i];</span><br><span class="line">    }</span><br><span class="line">    aes_key-&gt;dk = d;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AES_KeyDelete</span><span class="params">(AES_Key aes_key)</span> </span>{</span><br><span class="line">    <span class="built_in">free</span>(aes_key.ek);</span><br><span class="line">    <span class="built_in">free</span>(aes_key.dk);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AES_Encrypt</span><span class="params">(<span class="type">uint8_t</span>* plaintext, <span class="type">uint8_t</span>* ciphertext, AES_Key aes_key)</span> </span>{</span><br><span class="line">    <span class="type">uint32_t</span> s[<span class="number">4</span>];</span><br><span class="line">    <span class="type">uint32_t</span> t[<span class="number">4</span>];</span><br><span class="line">    <span class="type">uint32_t</span> tmp;</span><br><span class="line">    <span class="comment">//------------Load as BigEndian------------------</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) {</span><br><span class="line">        s[i] = (plaintext[<span class="number">4</span> * i + <span class="number">0</span>] &lt;&lt; <span class="number">24</span>) | (plaintext[<span class="number">4</span> * i + <span class="number">1</span>] &lt;&lt; <span class="number">16</span>) |</span><br><span class="line">            (plaintext[<span class="number">4</span> * i + <span class="number">2</span>] &lt;&lt; <span class="number">8</span>) | (plaintext[<span class="number">4</span> * i + <span class="number">3</span>]);</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">//----------------AddRoundKey----------------</span></span><br><span class="line">    s[<span class="number">0</span>] ^= aes_key.ek[<span class="number">0</span>];</span><br><span class="line">    s[<span class="number">1</span>] ^= aes_key.ek[<span class="number">1</span>];</span><br><span class="line">    s[<span class="number">2</span>] ^= aes_key.ek[<span class="number">2</span>];</span><br><span class="line">    s[<span class="number">3</span>] ^= aes_key.ek[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; aes_key.nr; i++) {</span><br><span class="line">        <span class="comment">//-------ShiftRow + SubByte + MixCol-------------</span></span><br><span class="line">        <span class="comment">// t0</span></span><br><span class="line">        t[<span class="number">0</span>] = TE[(s[<span class="number">0</span>] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        tmp = TE[(s[<span class="number">1</span>] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">0</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">8</span>);</span><br><span class="line">        tmp = TE[(s[<span class="number">2</span>] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">0</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">16</span>);</span><br><span class="line">        tmp = TE[(s[<span class="number">3</span>] &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">0</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">24</span>);</span><br><span class="line">        <span class="comment">// t1</span></span><br><span class="line">        t[<span class="number">1</span>] = TE[(s[<span class="number">1</span>] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        tmp = TE[(s[<span class="number">2</span>] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">1</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">8</span>);</span><br><span class="line">        tmp = TE[(s[<span class="number">3</span>] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">1</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">16</span>);</span><br><span class="line">        tmp = TE[(s[<span class="number">0</span>] &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">1</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">24</span>);</span><br><span class="line">        <span class="comment">// t2</span></span><br><span class="line">        t[<span class="number">2</span>] = TE[(s[<span class="number">2</span>] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        tmp = TE[(s[<span class="number">3</span>] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">2</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">8</span>);</span><br><span class="line">        tmp = TE[(s[<span class="number">0</span>] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">2</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">16</span>);</span><br><span class="line">        tmp = TE[(s[<span class="number">1</span>] &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">2</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">24</span>);</span><br><span class="line">        <span class="comment">// t3</span></span><br><span class="line">        t[<span class="number">3</span>] = TE[(s[<span class="number">3</span>] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        tmp = TE[(s[<span class="number">0</span>] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">3</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">8</span>);</span><br><span class="line">        tmp = TE[(s[<span class="number">1</span>] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">3</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">16</span>);</span><br><span class="line">        tmp = TE[(s[<span class="number">2</span>] &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">3</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">24</span>);</span><br><span class="line">        <span class="comment">//-------------AddRoundKey---------------</span></span><br><span class="line">        s[<span class="number">0</span>] = t[<span class="number">0</span>] ^ aes_key.ek[<span class="number">4</span> * i + <span class="number">0</span>];</span><br><span class="line">        s[<span class="number">1</span>] = t[<span class="number">1</span>] ^ aes_key.ek[<span class="number">4</span> * i + <span class="number">1</span>];</span><br><span class="line">        s[<span class="number">2</span>] = t[<span class="number">2</span>] ^ aes_key.ek[<span class="number">4</span> * i + <span class="number">2</span>];</span><br><span class="line">        s[<span class="number">3</span>] = t[<span class="number">3</span>] ^ aes_key.ek[<span class="number">4</span> * i + <span class="number">3</span>];</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">//------------ShiftRow + SubByte-----------</span></span><br><span class="line">    <span class="comment">// t0</span></span><br><span class="line">    t[<span class="number">0</span>] = Sbox[(s[<span class="number">0</span>] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">24</span>;</span><br><span class="line">    t[<span class="number">0</span>] |= Sbox[(s[<span class="number">1</span>] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">16</span>;</span><br><span class="line">    t[<span class="number">0</span>] |= Sbox[(s[<span class="number">2</span>] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">    t[<span class="number">0</span>] |= Sbox[(s[<span class="number">3</span>] &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// t1</span></span><br><span class="line">    t[<span class="number">1</span>] = Sbox[(s[<span class="number">1</span>] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">24</span>;</span><br><span class="line">    t[<span class="number">1</span>] |= Sbox[(s[<span class="number">2</span>] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">16</span>;</span><br><span class="line">    t[<span class="number">1</span>] |= Sbox[(s[<span class="number">3</span>] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">    t[<span class="number">1</span>] |= Sbox[(s[<span class="number">0</span>] &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// t2</span></span><br><span class="line">    t[<span class="number">2</span>] = Sbox[(s[<span class="number">2</span>] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">24</span>;</span><br><span class="line">    t[<span class="number">2</span>] |= Sbox[(s[<span class="number">3</span>] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">16</span>;</span><br><span class="line">    t[<span class="number">2</span>] |= Sbox[(s[<span class="number">0</span>] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">    t[<span class="number">2</span>] |= Sbox[(s[<span class="number">1</span>] &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// t3</span></span><br><span class="line">    t[<span class="number">3</span>] = Sbox[(s[<span class="number">3</span>] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">24</span>;</span><br><span class="line">    t[<span class="number">3</span>] |= Sbox[(s[<span class="number">0</span>] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">16</span>;</span><br><span class="line">    t[<span class="number">3</span>] |= Sbox[(s[<span class="number">1</span>] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">    t[<span class="number">3</span>] |= Sbox[(s[<span class="number">2</span>] &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//------------AddRoundKey-------------</span></span><br><span class="line">    s[<span class="number">0</span>] = t[<span class="number">0</span>] ^ aes_key.ek[<span class="number">4</span> * aes_key.nr + <span class="number">0</span>];</span><br><span class="line">    s[<span class="number">1</span>] = t[<span class="number">1</span>] ^ aes_key.ek[<span class="number">4</span> * aes_key.nr + <span class="number">1</span>];</span><br><span class="line">    s[<span class="number">2</span>] = t[<span class="number">2</span>] ^ aes_key.ek[<span class="number">4</span> * aes_key.nr + <span class="number">2</span>];</span><br><span class="line">    s[<span class="number">3</span>] = t[<span class="number">3</span>] ^ aes_key.ek[<span class="number">4</span> * aes_key.nr + <span class="number">3</span>];</span><br><span class="line">    <span class="comment">//-----------Store as BigEndian--------------</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) {</span><br><span class="line">        ciphertext[<span class="number">4</span> * i + <span class="number">0</span>] = (s[i] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        ciphertext[<span class="number">4</span> * i + <span class="number">1</span>] = (s[i] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        ciphertext[<span class="number">4</span> * i + <span class="number">2</span>] = (s[i] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        ciphertext[<span class="number">4</span> * i + <span class="number">3</span>] = (s[i] &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AES_Decrypt</span><span class="params">(<span class="type">uint8_t</span>* ciphertext, <span class="type">uint8_t</span>* plaintext, AES_Key aes_key)</span> </span>{</span><br><span class="line">    <span class="type">uint32_t</span> s[<span class="number">4</span>];</span><br><span class="line">    <span class="type">uint32_t</span> t[<span class="number">4</span>];</span><br><span class="line">    <span class="type">uint32_t</span> tmp;</span><br><span class="line">    <span class="comment">//------------Load as BigEndian------------------</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) {</span><br><span class="line">        s[i] = (ciphertext[<span class="number">4</span> * i + <span class="number">0</span>] &lt;&lt; <span class="number">24</span>) | (ciphertext[<span class="number">4</span> * i + <span class="number">1</span>] &lt;&lt; <span class="number">16</span>) |</span><br><span class="line">            (ciphertext[<span class="number">4</span> * i + <span class="number">2</span>] &lt;&lt; <span class="number">8</span>) | (ciphertext[<span class="number">4</span> * i + <span class="number">3</span>]);</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">//----------------AddRoundKey----------------</span></span><br><span class="line">    s[<span class="number">0</span>] ^= aes_key.dk[<span class="number">4</span> * aes_key.nr + <span class="number">0</span>];</span><br><span class="line">    s[<span class="number">1</span>] ^= aes_key.dk[<span class="number">4</span> * aes_key.nr + <span class="number">1</span>];</span><br><span class="line">    s[<span class="number">2</span>] ^= aes_key.dk[<span class="number">4</span> * aes_key.nr + <span class="number">2</span>];</span><br><span class="line">    s[<span class="number">3</span>] ^= aes_key.dk[<span class="number">4</span> * aes_key.nr + <span class="number">3</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = aes_key.nr - <span class="number">1</span>; i &gt; <span class="number">0</span>; i--) {</span><br><span class="line">        <span class="comment">//-------ShiftRow IV + SubByte IV + MixCol IV-------------</span></span><br><span class="line">        <span class="comment">// t0</span></span><br><span class="line">        t[<span class="number">0</span>] = TD[(s[<span class="number">0</span>] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        tmp = TD[(s[<span class="number">3</span>] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">0</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">8</span>);</span><br><span class="line">        tmp = TD[(s[<span class="number">2</span>] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">0</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">16</span>);</span><br><span class="line">        tmp = TD[(s[<span class="number">1</span>] &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">0</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">24</span>);</span><br><span class="line">        <span class="comment">// t1</span></span><br><span class="line">        t[<span class="number">1</span>] = TD[(s[<span class="number">1</span>] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        tmp = TD[(s[<span class="number">0</span>] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">1</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">8</span>);</span><br><span class="line">        tmp = TD[(s[<span class="number">3</span>] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">1</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">16</span>);</span><br><span class="line">        tmp = TD[(s[<span class="number">2</span>] &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">1</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">24</span>);</span><br><span class="line">        <span class="comment">// t2</span></span><br><span class="line">        t[<span class="number">2</span>] = TD[(s[<span class="number">2</span>] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        tmp = TD[(s[<span class="number">1</span>] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">2</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">8</span>);</span><br><span class="line">        tmp = TD[(s[<span class="number">0</span>] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">2</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">16</span>);</span><br><span class="line">        tmp = TD[(s[<span class="number">3</span>] &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">2</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">24</span>);</span><br><span class="line">        <span class="comment">// t3</span></span><br><span class="line">        t[<span class="number">3</span>] = TD[(s[<span class="number">3</span>] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        tmp = TD[(s[<span class="number">2</span>] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">3</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">8</span>);</span><br><span class="line">        tmp = TD[(s[<span class="number">1</span>] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">3</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">16</span>);</span><br><span class="line">        tmp = TD[(s[<span class="number">0</span>] &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>];</span><br><span class="line">        t[<span class="number">3</span>] ^= <span class="built_in">rotr32</span>(tmp, <span class="number">24</span>);</span><br><span class="line">        <span class="comment">//-------------AddRoundKey---------------</span></span><br><span class="line">        s[<span class="number">0</span>] = t[<span class="number">0</span>] ^ aes_key.dk[<span class="number">4</span> * i + <span class="number">0</span>];</span><br><span class="line">        s[<span class="number">1</span>] = t[<span class="number">1</span>] ^ aes_key.dk[<span class="number">4</span> * i + <span class="number">1</span>];</span><br><span class="line">        s[<span class="number">2</span>] = t[<span class="number">2</span>] ^ aes_key.dk[<span class="number">4</span> * i + <span class="number">2</span>];</span><br><span class="line">        s[<span class="number">3</span>] = t[<span class="number">3</span>] ^ aes_key.dk[<span class="number">4</span> * i + <span class="number">3</span>];</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">//------------ShiftRow + SubByte-----------</span></span><br><span class="line">    <span class="comment">// t0</span></span><br><span class="line">    t[<span class="number">0</span>] = SboxIV[(s[<span class="number">0</span>] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">24</span>;</span><br><span class="line">    t[<span class="number">0</span>] |= SboxIV[(s[<span class="number">3</span>] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">16</span>;</span><br><span class="line">    t[<span class="number">0</span>] |= SboxIV[(s[<span class="number">2</span>] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">    t[<span class="number">0</span>] |= SboxIV[(s[<span class="number">1</span>] &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// t1</span></span><br><span class="line">    t[<span class="number">1</span>] = SboxIV[(s[<span class="number">1</span>] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">24</span>;</span><br><span class="line">    t[<span class="number">1</span>] |= SboxIV[(s[<span class="number">0</span>] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">16</span>;</span><br><span class="line">    t[<span class="number">1</span>] |= SboxIV[(s[<span class="number">3</span>] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">    t[<span class="number">1</span>] |= SboxIV[(s[<span class="number">2</span>] &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// t2</span></span><br><span class="line">    t[<span class="number">2</span>] = SboxIV[(s[<span class="number">2</span>] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">24</span>;</span><br><span class="line">    t[<span class="number">2</span>] |= SboxIV[(s[<span class="number">1</span>] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">16</span>;</span><br><span class="line">    t[<span class="number">2</span>] |= SboxIV[(s[<span class="number">0</span>] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">    t[<span class="number">2</span>] |= SboxIV[(s[<span class="number">3</span>] &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// t3</span></span><br><span class="line">    t[<span class="number">3</span>] = SboxIV[(s[<span class="number">3</span>] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">24</span>;</span><br><span class="line">    t[<span class="number">3</span>] |= SboxIV[(s[<span class="number">2</span>] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">16</span>;</span><br><span class="line">    t[<span class="number">3</span>] |= SboxIV[(s[<span class="number">1</span>] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">    t[<span class="number">3</span>] |= SboxIV[(s[<span class="number">0</span>] &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>] &lt;&lt; <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//------------AddRoundKey-------------</span></span><br><span class="line">    s[<span class="number">0</span>] = t[<span class="number">0</span>] ^ aes_key.dk[<span class="number">0</span>];</span><br><span class="line">    s[<span class="number">1</span>] = t[<span class="number">1</span>] ^ aes_key.dk[<span class="number">1</span>];</span><br><span class="line">    s[<span class="number">2</span>] = t[<span class="number">2</span>] ^ aes_key.dk[<span class="number">2</span>];</span><br><span class="line">    s[<span class="number">3</span>] = t[<span class="number">3</span>] ^ aes_key.dk[<span class="number">3</span>];</span><br><span class="line">    <span class="comment">//-----------Store as BigEndian--------------</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) {</span><br><span class="line">        plaintext[<span class="number">4</span> * i + <span class="number">0</span>] = (s[i] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        plaintext[<span class="number">4</span> * i + <span class="number">1</span>] = (s[i] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        plaintext[<span class="number">4</span> * i + <span class="number">2</span>] = (s[i] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        plaintext[<span class="number">4</span> * i + <span class="number">3</span>] = (s[i] &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">    AES_Key aes_key;</span><br><span class="line">    <span class="comment">// 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 10 11 12 13 14 15 16 17</span></span><br><span class="line">    <span class="comment">// 18 19 1a 1b 1c 1d 1e 1f</span></span><br><span class="line">    <span class="type">uint8_t</span> key[<span class="number">256</span> / <span class="number">8</span>] = { <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>,</span><br><span class="line">                            <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0a</span>, <span class="number">0x0b</span>, <span class="number">0x0c</span>, <span class="number">0x0d</span>, <span class="number">0x0e</span>, <span class="number">0x0f</span>,</span><br><span class="line">                            <span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x17</span>,</span><br><span class="line">                            <span class="number">0x18</span>, <span class="number">0x19</span>, <span class="number">0x1a</span>, <span class="number">0x1b</span>, <span class="number">0x1c</span>, <span class="number">0x1d</span>, <span class="number">0x1e</span>, <span class="number">0x1f</span> };</span><br><span class="line">    <span class="comment">// 00 11 22 33 44 55 66 77 88 99 aa bb cc dd ee ff</span></span><br><span class="line">    <span class="type">uint8_t</span> plaintext[<span class="number">16</span>] = { <span class="number">0x00</span>, <span class="number">0x11</span>, <span class="number">0x22</span>, <span class="number">0x33</span>, <span class="number">0x44</span>, <span class="number">0x55</span>, <span class="number">0x66</span>, <span class="number">0x77</span>,</span><br><span class="line">                             <span class="number">0x88</span>, <span class="number">0x99</span>, <span class="number">0xaa</span>, <span class="number">0xbb</span>, <span class="number">0xcc</span>, <span class="number">0xdd</span>, <span class="number">0xee</span>, <span class="number">0xff</span> };</span><br><span class="line">    <span class="type">uint8_t</span> ciphertext[<span class="number">16</span>];</span><br><span class="line">    <span class="comment">//-----------AES 128-------------------</span></span><br><span class="line">    <span class="type">int</span> success = <span class="built_in">AES_KeyInit</span>(key, &amp;aes_key, <span class="number">128</span>);</span><br><span class="line">    <span class="keyword">if</span> (success) {</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"-----------AES 128-------------\n"</span>);</span><br><span class="line">        <span class="comment">// 69 c4 e0 d8 6a 7b 04 30 d8 cd b7 80 70 b4 c5 5a</span></span><br><span class="line">        <span class="built_in">AES_Encrypt</span>(plaintext, ciphertext, aes_key);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) {</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%02x "</span>, ciphertext[i]);</span><br><span class="line">        }</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">        <span class="comment">// 00 11 22 33 44 55 66 77 88 99 aa bb cc dd ee ff</span></span><br><span class="line">        <span class="built_in">AES_Decrypt</span>(ciphertext, plaintext, aes_key);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) {</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%02x "</span>, plaintext[i]);</span><br><span class="line">        }</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">        <span class="built_in">AES_KeyDelete</span>(aes_key);</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">//-----------AES 196-------------------</span></span><br><span class="line">    success = <span class="built_in">AES_KeyInit</span>(key, &amp;aes_key, <span class="number">196</span>);</span><br><span class="line">    <span class="keyword">if</span> (success) {</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"-----------AES 196-------------\n"</span>);</span><br><span class="line">        <span class="comment">// dd a9 7c a4 86 4c df e0 6e af 70 a0 ec 0d 71 91</span></span><br><span class="line">        <span class="built_in">AES_Encrypt</span>(plaintext, ciphertext, aes_key);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) {</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%02x "</span>, ciphertext[i]);</span><br><span class="line">        }</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">        <span class="comment">// 00 11 22 33 44 55 66 77 88 99 aa bb cc dd ee ff</span></span><br><span class="line">        <span class="built_in">AES_Decrypt</span>(ciphertext, plaintext, aes_key);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) {</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%02x "</span>, plaintext[i]);</span><br><span class="line">        }</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">        <span class="built_in">AES_KeyDelete</span>(aes_key);</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">//------------AES 256-----------------</span></span><br><span class="line">    success = <span class="built_in">AES_KeyInit</span>(key, &amp;aes_key, <span class="number">256</span>);</span><br><span class="line">    <span class="keyword">if</span> (success) {</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"-----------AES 256-------------\n"</span>);</span><br><span class="line">        <span class="comment">// 8e a2 b7 ca 51 67 45 bf ea fc 49 90 4b 49 60 89</span></span><br><span class="line">        <span class="built_in">AES_Encrypt</span>(plaintext, ciphertext, aes_key);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) {</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%02x "</span>, ciphertext[i]);</span><br><span class="line">        }</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">        <span class="comment">// 00 11 22 33 44 55 66 77 88 99 aa bb cc dd ee ff</span></span><br><span class="line">        <span class="built_in">AES_Decrypt</span>(ciphertext, plaintext, aes_key);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) {</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%02x "</span>, plaintext[i]);</span><br><span class="line">        }</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">        <span class="built_in">AES_KeyDelete</span>(aes_key);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="注意点："><a href="#注意点：" class="headerlink" title="注意点："></a>注意点：</h2><p>加解密密钥在查表法aes中不同</p>
<p>逆向时拿到其中一个可以推导另一个</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dk<span class="section">[0]</span>  = ek<span class="section">[10]</span><span class="comment">;                     // 最后一轮密钥直接用</span></span><br><span class="line">dk<span class="section">[10]</span> = ek<span class="section">[0]</span><span class="comment">;                      // 第一轮密钥直接用</span></span><br><span class="line">dk<span class="section">[i]</span>  = InvMixColumns(ek<span class="section">[10 - i]</span>)<span class="comment">;  // 中间轮要过一次逆MixColumns</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>不需要研究透算法逻辑，只需要知道大致原理和遇到时能识别出这是aes变种就可以了</p>
<h1 id="白盒aes"><a href="#白盒aes" class="headerlink" title="白盒aes"></a>白盒aes</h1><p>白盒aes算是在逆向中最常见到的了，特点是隐藏密钥。</p>
<p>查表法 AES 提供了“把轮操作变成查表”的思路，白盒 AES 则利用这个查表方法隐藏密钥，</p>
<p>白盒 AES 和 “查表法 AES” 算法是同一回事，可以把白盒AES看成查表AES的加强版(把密钥也混淆进表里了)，一些密码学库会在 AES_init 的时候预处理并展开 key；如果 key 是字面量，还可能在编译时进行常量计算。这样编译后的可执行文件中就没有明文 key 了。</p>
<h2 id="DFA攻击"><a href="#DFA攻击" class="headerlink" title="DFA攻击"></a>DFA攻击</h2><p>白盒aes最主要的破解方式就是dfa攻击</p>
<p>我们需要的攻击条件：</p>
<ul>
<li><p>我们可以反汇编出源代码并调试它</p>
</li>
<li><p>pip install phoenixAES</p>
</li>
<li><p>编译这里面的<a target="_blank" rel="noopener" href="https://github.com/SideChannelMarvels/Stark">GitHub - SideChannelMarvels/Stark: Repository of small utilities related to key recovery</a>的aes_keyschedule.c</p>
</li>
</ul>
<h2 id="原理：-1"><a href="#原理：-1" class="headerlink" title="原理："></a>原理：</h2><p>在白盒攻击模型中，我们可以通过DBI工具（比如Frida），Debuggger（比如IDA），修改二进制文件本身 （SO patch）来实现对 中一个字节的更改，这可以称为引导、诱发一个错误。 因此差分故障攻击或差分错误攻击都是DFA合适的名字，下面修改明文中中第一个字节的值</p>
<p>首先是初始轮密钥加，错误限于这一个字节</p>
<p><img data-src="/images/aes/DFA1.png" alt="DFA1"></p>
<p>然后是第一轮的字节替换，错误限于这一个字节</p>
<p><img data-src="/images/aes/DFA2.png" alt="DFA2"></p>
<p>然后是第一轮的循环左移，因为是第一行，所以没动。</p>
<p><img data-src="/images/aes/DFA3.png" alt="DFA3"></p>
<p>然后是第一轮的列混淆步骤，结果的第m行第n列的值等于矩阵A的第m行的元素与矩阵B的第n列对应元素乘积之和，因此结果中第一列的每一个元素都受到矩阵B（即下图左边）第一列中每个元素的影响。因而，一个字节的错误被扩散到了一整列。或者说，正常情况和故障情况在第一轮列混淆结束后，有四个字节的值不同。</p>
<p><img data-src="/images/aes/DFA4.png" alt="DFA4"></p>
<p>然后是第一轮的轮密钥加，它只作用用当前字节，不会将差异扩散出去。</p>
<p><img data-src="/images/aes/DFA5.png" alt="DFA5"></p>
<p>可以看到，在一轮循环后，一个字节的故障，被扩散到了四个字节上。继续第二轮。<br>第二轮的字节替换</p>
<p><img data-src="/images/aes/DFA6.png" alt="DFA6"></p>
<p>第二轮的循环左移，需要注意到，虽然差异还是四个字节，但被扩散到不同的四列去了。</p>
<p><img data-src="/images/aes/DFA7.png" alt="DFA7"></p>
<p>第二轮的列混淆，每列存在的差异扩散到整列，这导致state的全部字节都与原先有差异。</p>
<p><img data-src="/images/aes/DFA8.png" alt="DFA8"></p>
<p>所以DFA攻击就是从第9轮攻击的行移位和列混淆中间更改1个数据，创造差错点，然后从最后拿到密文来分析故障结果(有四个差错点)，由于aes一次可加密16个字节，所以可以得出16种不同的故障情况，那我们就可以通过数学间的关系，把密钥反解出来</p>
<h2 id="攻击实现"><a href="#攻击实现" class="headerlink" title="攻击实现"></a>攻击实现</h2><p>在调试时更改第九轮对应字节即可，明文要求输入的话直接全输入\x00，在第9轮进行故障注入，假设正常明文(无故障)加密结果为0x8df4e9aac5c7573a27d8d055d6e4d64b</p>
<p>注入时把第一个字节改为0x10,第十轮结束后结果：</p>
<p><strong>8d</strong> f4 e9 aa c5 c7 57 <strong>3a</strong> 27 d8 <strong>d0</strong> 55 d6 <strong>e4</strong> d6 4b<br><strong>da</strong> f4 e9 aa c5 c7 57 <strong>c9</strong> 27 d8 <strong>53</strong> 55 d6 <strong>37</strong> d6 4b<br>确实有4个字节不一样。以此类推，得到16个不一样的带差错的密文</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">daf4e9aac5c757c927d85355d637d64b</span><br><span class="line">47f4e9aac5c7577d27d8a655d61ed64b</span><br><span class="line">79f4e9aac5c7572a27d89855d62ad64b</span><br><span class="line">30f4e9aac5c7570b27d86555d6a5d64b</span><br><span class="line">8d7de9aac8c7573a27d8d09ed6e4be4b</span><br><span class="line">8d5ce9aa43c7573a27d8d04cd6e4054b</span><br><span class="line">8d0de9aaddc7573a27d8d060d6e4234b</span><br><span class="line">8dabe9aacac7573a27d8d009d6e4484b</span><br><span class="line">8df48caac598573a62d8d055d6e4d636</span><br><span class="line">8df4bbaac5f4573acdd8d055d6e4d693</span><br><span class="line">8df47aaac576573ac1d8d055d6e4d61c</span><br><span class="line">8df444aac5c8573a23d8d055d6e4d6fb</span><br><span class="line">8df4e9e0c5c7b73a2768d055ade4d64b</span><br><span class="line">8df4e9f2c5c7063a27a4d055dfe4d64b</span><br><span class="line">8df4e942c5c7793a275ed05535e4d64b</span><br><span class="line">8df4e98fc5c7fa3a2778d055b3e4d64b</span><br></pre></td></tr></table></figure>
<p>有了这个以后我们就可以还原得到第十轮的密钥了，这里使用<a target="_blank" rel="noopener" href="https://github.com/SideChannelMarvels/JeanGrey/tree/master/phoenixAES">phoenixAES</a>工具，先安装：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install phoenixAES</span><br></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> phoenixAES</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">'tracefile'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> t:</span><br><span class="line">    t.write(<span class="string">"""</span></span><br><span class="line"><span class="string">8df4e9aac5c7573a27d8d055d6e4d64b</span></span><br><span class="line"><span class="string">daf4e9aac5c757c927d85355d637d64b</span></span><br><span class="line"><span class="string">47f4e9aac5c7577d27d8a655d61ed64b</span></span><br><span class="line"><span class="string">79f4e9aac5c7572a27d89855d62ad64b</span></span><br><span class="line"><span class="string">30f4e9aac5c7570b27d86555d6a5d64b</span></span><br><span class="line"><span class="string">8d7de9aac8c7573a27d8d09ed6e4be4b</span></span><br><span class="line"><span class="string">8d5ce9aa43c7573a27d8d04cd6e4054b</span></span><br><span class="line"><span class="string">8d0de9aaddc7573a27d8d060d6e4234b</span></span><br><span class="line"><span class="string">8dabe9aacac7573a27d8d009d6e4484b</span></span><br><span class="line"><span class="string">8df48caac598573a62d8d055d6e4d636</span></span><br><span class="line"><span class="string">8df4bbaac5f4573acdd8d055d6e4d693</span></span><br><span class="line"><span class="string">8df47aaac576573ac1d8d055d6e4d61c</span></span><br><span class="line"><span class="string">8df444aac5c8573a23d8d055d6e4d6fb</span></span><br><span class="line"><span class="string">8df4e9e0c5c7b73a2768d055ade4d64b</span></span><br><span class="line"><span class="string">8df4e9f2c5c7063a27a4d055dfe4d64b</span></span><br><span class="line"><span class="string">8df4e942c5c7793a275ed05535e4d64b</span></span><br><span class="line"><span class="string">8df4e98fc5c7fa3a2778d055b3e4d64b</span></span><br><span class="line"><span class="string">"""</span>.encode(<span class="string">'utf8'</span>))</span><br><span class="line">phoenixAES.crack_file(<span class="string">'tracefile'</span>, [], <span class="literal">True</span>, <span class="literal">False</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p>一共写入了17行数据到文件，其中第一行为正确的密文，剩余16行都是故障密文，最终通过crack_file即可得到第10轮密钥：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Last round key <span class="comment">#N found:</span></span><br><span class="line">D014F9A8C9EE2589E13F0CC8B6630CA6</span><br></pre></td></tr></table></figure>
<h3 id="还原最初密钥："><a href="#还原最初密钥：" class="headerlink" title="还原最初密钥："></a>还原最初密钥：</h3><p>接下来用开头DFA攻击第三个工具里的aes_keyschedule.c，在本地编译后运行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./aes_keyschedule 5D432583B2AA833FC22D53130FDA904C 10</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">./aes_keyschedule D014F9A8C9EE2589E13F0CC8B6630CA6 10</span><br><span class="line">K00: 2B7E151628AED2A6ABF7158809CF4F3C</span><br><span class="line">K01: A0FAFE1788542CB123A339392A6C7605</span><br><span class="line">K02: F2C295F27A96B9435935807A7359F67F</span><br><span class="line">K03: 3D80477D4716FE3E1E237E446D7A883B</span><br><span class="line">K04: EF44A541A8525B7FB671253BDB0BAD00</span><br><span class="line">K05: D4D1C6F87C839D87CAF2B8BC11F915BC</span><br><span class="line">K06: 6D88A37A110B3EFDDBF98641CA0093FD</span><br><span class="line">K07: 4E54F70E5F5FC9F384A64FB24EA6DC4F</span><br><span class="line">K08: EAD27321B58DBAD2312BF5607F8D292F</span><br><span class="line">K09: AC7766F319FADC2128D12941575C006E</span><br><span class="line">K10: D014F9A8C9EE2589E13F0CC8B6630CA6</span><br></pre></td></tr></table></figure>
<p>即可得到密钥为2B7E151628AED2A6ABF7158809CF4F3C</p>
<p>最后附上白盒aes的实现代码，有兴趣的可以自己看一看<a target="_blank" rel="noopener" href="https://github.com/Nexus-TYF/Xiao-Lai-White-box-AES">GitHub - Nexus-TYF/Xiao-Lai-White-box-AES: A Xiao-Lai's white-box AES implementation.</a></p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/42264499">https://zhuanlan.zhihu.com/p/42264499</a></p>
<p><a target="_blank" rel="noopener" href="http://91fans.com.cn/post/ilikeaestwo/#gsc.tab=0">找回消失的密钥 —- DFA分析白盒AES算法 - 奋飞安全</a></p>
<p><a target="_blank" rel="noopener" href="https://www.zskkk.cn/posts/15785/#%E8%BF%98%E5%8E%9F%E5%AF%86%E6%96%87">https://www.zskkk.cn/posts/15785/#%E8%BF%98%E5%8E%9F%E5%AF%86%E6%96%87</a></p>

    </div>

    
    
    
        <div class="reward-container">
  <div>您的支持将鼓励我继续创作!</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/reward.jpg" alt="s0m1ng 微信支付">
        <p>微信支付</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>s0m1ng
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://example.com/2025/10/09/%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6/aes2/" title="逆向中的AES(二)">http://example.com/2025/10/09/逆向中的密码学/aes2/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/aes/" rel="tag"><i class="fa fa-tag"></i> aes</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/10/09/pe%E9%80%86%E5%90%91/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E6%9C%BA%E5%88%B6%E4%B8%8A-SEH/" rel="prev" title="异常处理机制-SEH">
      <i class="fa fa-chevron-left"></i> 异常处理机制-SEH
    </a></div>
      <div class="post-nav-item">
    <a href="/2025/10/09/%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6/aes1/" rel="next" title="逆向中的AES(一)">
      逆向中的AES(一) <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80%EF%BC%9A"><span class="nav-number">1.</span> <span class="nav-text">前言：</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9F%A5%E8%A1%A8%E6%B3%95%E5%AE%9E%E7%8E%B0%E7%9A%84aes%EF%BC%9A"><span class="nav-number">2.</span> <span class="nav-text">查表法实现的aes：</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%9F%E7%90%86%EF%BC%9A"><span class="nav-number">2.1.</span> <span class="nav-text">原理：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%EF%BC%9A"><span class="nav-number">2.2.</span> <span class="nav-text">代码实现：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F%E7%82%B9%EF%BC%9A"><span class="nav-number">2.3.</span> <span class="nav-text">注意点：</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%99%BD%E7%9B%92aes"><span class="nav-number">3.</span> <span class="nav-text">白盒aes</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#DFA%E6%94%BB%E5%87%BB"><span class="nav-number">3.1.</span> <span class="nav-text">DFA攻击</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%9F%E7%90%86%EF%BC%9A-1"><span class="nav-number">3.2.</span> <span class="nav-text">原理：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%94%BB%E5%87%BB%E5%AE%9E%E7%8E%B0"><span class="nav-number">3.3.</span> <span class="nav-text">攻击实现</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%98%E5%8E%9F%E6%9C%80%E5%88%9D%E5%AF%86%E9%92%A5%EF%BC%9A"><span class="nav-number">3.3.1.</span> <span class="nav-text">还原最初密钥：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Reference"><span class="nav-number">4.</span> <span class="nav-text">Reference</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="s0m1ng"
      src="/images/profile_photo.jpg">
  <p class="site-author-name" itemprop="name">s0m1ng</p>
  <div class="site-description" itemprop="description">学习逆向贵在坚持</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">14</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="http://wpa.qq.com/msgrd?v=3&uin=1327470638&site=qq&menu=yes" title="QQ → http:&#x2F;&#x2F;wpa.qq.com&#x2F;msgrd?v&#x3D;3&amp;uin&#x3D;1327470638&amp;site&#x3D;qq&amp;menu&#x3D;yes" rel="noopener" target="_blank"><i class="fab fa-qq fa-fw"></i>QQ</a>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">s0m1ng</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script size="300" alpha="0.6" zIndex="-1" src="/lib/canvas-ribbon/canvas-ribbon.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
